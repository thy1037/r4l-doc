<!DOCTYPE HTML>
<html lang="zh" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>r4l</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="env.html"><strong aria-hidden="true">1.</strong> 环境搭建</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="env_docker.html"><strong aria-hidden="true">1.1.</strong> Docker 安装</a></li><li class="chapter-item expanded "><a href="env_docker_config.html"><strong aria-hidden="true">1.2.</strong> Docker 配置</a></li><li class="chapter-item expanded "><a href="env_01.html"><strong aria-hidden="true">1.3.</strong> qemu + linux6.1</a></li><li class="chapter-item expanded "><a href="env_02.html"><strong aria-hidden="true">1.4.</strong> qemu + gdb (TODO)</a></li><li class="chapter-item expanded "><a href="env_03.html"><strong aria-hidden="true">1.5.</strong> qemu + vscode (TODO)</a></li></ol></li><li class="chapter-item expanded "><a href="c.html"><strong aria-hidden="true">2.</strong> C 驱动开发</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="c_01.html"><strong aria-hidden="true">2.1.</strong> 最简驱动体验</a></li><li class="chapter-item expanded "><a href="c_02.html"><strong aria-hidden="true">2.2.</strong> 其它 (TODO)</a></li></ol></li><li class="chapter-item expanded "><a href="rust.html"><strong aria-hidden="true">3.</strong> rust 驱动开发</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="rust_01.html"><strong aria-hidden="true">3.1.</strong> 最简驱动体验</a></li><li class="chapter-item expanded "><a href="rust_mini_ko.html"><strong aria-hidden="true">3.2.</strong> 编译最简 ko 模块</a></li><li class="chapter-item expanded "><a href="rust_fujita_e1000.html"><strong aria-hidden="true">3.3.</strong> linux-fujita + e1000</a></li><li class="chapter-item expanded "><a href="rust_stm32h743_eth_c.html"><strong aria-hidden="true">3.4.</strong> STM32H743 以太网外设初始化分析</a></li><li class="chapter-item expanded "><a href="rust_add_llvm_log.html"><strong aria-hidden="true">3.5.</strong> LLVM 修复记录</a></li><li class="chapter-item expanded "><a href="rust_register_cmp.html"><strong aria-hidden="true">3.6.</strong> 寄存器对比</a></li><li class="chapter-item expanded "><a href="rust_register_info.html"><strong aria-hidden="true">3.7.</strong> 寄存器说明</a></li><li class="chapter-item expanded "><a href="rust_c_drv.html"><strong aria-hidden="true">3.8.</strong> C 驱动分析</a></li><li class="chapter-item expanded "><a href="rust_02.html"><strong aria-hidden="true">3.9.</strong> 其它 (TODO)</a></li></ol></li><li class="chapter-item expanded "><a href="other.html"><strong aria-hidden="true">4.</strong> 其它</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="other_git_depth_checkout.html"><strong aria-hidden="true">4.1.</strong> depth 1 情况下切换分支</a></li></ol></li><li class="chapter-item expanded "><a href="iic-rust.html"><strong aria-hidden="true">5.</strong> IIC 驱动开发 (TODO)</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">r4l</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/thy1037/r4l-doc" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="环境搭建"><a class="header" href="#环境搭建">环境搭建</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="docker-安装"><a class="header" href="#docker-安装">Docker 安装</a></h1>
<p>为了统一开发环境，同时于其它开发环境做隔离，选择在 Docker 中做开发。</p>
<p>主要参考<a href="https://docs.docker.com/engine/install/">官网</a>的 <a href="https://docs.docker.com/engine/install/">Debian 系统安装教程</a></p>
<h2 id="卸载旧版本"><a class="header" href="#卸载旧版本">卸载旧版本</a></h2>
<pre><code class="language-bash">sudo apt remove docker docker-engine docker.io containerd runc
</code></pre>
<p>其中：</p>
<p><code>docker-engin</code> 在 Debian 仓库中已不存在，所以可能会报错，删除后重新执行即可。</p>
<h2 id="使用仓库安装"><a class="header" href="#使用仓库安装">使用仓库安装</a></h2>
<p>Docker 支持多种安装方式，这里选择通过 apt 仓库的形式安装。</p>
<h3 id="设置仓库"><a class="header" href="#设置仓库">设置仓库</a></h3>
<ol>
<li>更新 apt 包索引，并允许 apt 通过 HTTPS 使用仓库：</li>
</ol>
<pre><code class="language-bash">sudo apt update
sudo apt install ca-certificates curl gnupg
</code></pre>
<ol start="2">
<li>添加 Docker 的官方 GPG 密钥：</li>
</ol>
<pre><code class="language-bash">sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg
</code></pre>
<ol start="3">
<li>使用以下命令设置仓库</li>
</ol>
<pre><code class="language-bash">echo \
  &quot;deb [arch=&quot;$(dpkg --print-architecture)&quot; signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/debian \
  &quot;$(. /etc/os-release &amp;&amp; echo &quot;$VERSION_CODENAME&quot;)&quot; stable&quot; | \
  sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
</code></pre>
<h3 id="安装-docker-engine"><a class="header" href="#安装-docker-engine">安装 Docker Engine</a></h3>
<ol>
<li>更新 apt 包索引</li>
</ol>
<pre><code class="language-bash">sudo apt update
</code></pre>
<ol start="2">
<li>安装 Docker Engine, containerd 和 Docker Compose</li>
</ol>
<p>最新版：</p>
<pre><code class="language-bash">sudo apt install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
</code></pre>
<ol start="3">
<li>通过运行 <code>hello-world</code> 镜像来确认 Docker Engine 安装成功：</li>
</ol>
<pre><code class="language-bash">sudo docker run hello-world
</code></pre>
<p>成功输出：</p>
<pre><code class="language-bash">Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
2db29710123e: Pull complete 
Digest: sha256:4e83453afed1b4fa1a3500525091dbfca6ce1e66903fd4c01ff015dbcb1ba33e
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.
    (amd64)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/
</code></pre>
<h2 id="debian-镜像"><a class="header" href="#debian-镜像">Debian 镜像</a></h2>
<p>因为个人喜好，并且宿主机使用的 Debian 系统，所以 Docker 中依旧选择 Debian，但要说的是 Ubuntu 是支持最完善的系统镜像。</p>
<h2 id="安装镜像"><a class="header" href="#安装镜像">安装镜像</a></h2>
<p>通过运行 <code>hello-world</code> 发现，在本地没有镜像的情况下，Docker 会自动从<a href="https://hub.docker.com/">官方镜像仓库</a>中下载，所以执行运行：</p>
<pre><code class="language-bash">sudo docker run -it debian bash
</code></pre>
<p>其中：</p>
<p><strong>-i</strong>：开启交互（interactive） <br>
<strong>-t</strong>：开启终端（pseudo-TTY） <br>
<strong>debian</strong>：镜像名称 <br>
<strong>bash</strong>：应用名称</p>
<p>输出如下：</p>
<pre><code class="language-bash">Unable to find image 'debian:latest' locally
latest: Pulling from library/debian
b0248cf3e63c: Pull complete 
Digest: sha256:0a78ed641b76252739e28ebbbe8cdbd80dc367fba4502565ca839e5803cfd86e
Status: Downloaded newer image for debian:latest
root@8bfa66c20540:/# 
</code></pre>
<p>这是一个非常基础的 Debian 系统，在安装过程中可以看到下载的大小只有 55M 左右，其中包含的命令（可执行文件）非常少，需要根据使用需求安装各种开发工具。</p>
<h2 id="添加-sudo-权限"><a class="header" href="#添加-sudo-权限">添加 sudo 权限</a></h2>
<p>正常在安装完 Docker 后，所有命令都需要 sudo 权限，使用很不方便（但安全），可以将 docker 加入 sudo 用户组，即默认 sudo 权限运行，具体步骤如下：</p>
<ol>
<li>创建用户组
首先查看是否有用户组：</li>
</ol>
<pre><code class="language-bash">cat /etc/group | grep docker
</code></pre>
<p>如果没有则创建用户组：</p>
<pre><code class="language-bash">sudo groupadd docker
</code></pre>
<ol start="2">
<li>当前用户加入用户组</li>
</ol>
<pre><code class="language-bash">sudo gpasswd -a ${USER} docker
</code></pre>
<ol start="3">
<li>重启 docker 服务</li>
</ol>
<pre><code class="language-bash">sudo service docker restart
</code></pre>
<ol start="4">
<li>docker.sock 添加权限</li>
</ol>
<pre><code class="language-bash">sudo chmod a+r2 /var/run/docker.sock
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="docker-配置"><a class="header" href="#docker-配置">Docker 配置</a></h1>
<h2 id="qemu"><a class="header" href="#qemu">Qemu</a></h2>
<pre><code class="language-bash">apt install qemu-utils qemu-system-x86 qemu-system-gui
</code></pre>
<h2 id="busybox"><a class="header" href="#busybox">busybox</a></h2>
<pre><code class="language-bash">apt install cpio
</code></pre>
<h2 id="编译依赖"><a class="header" href="#编译依赖">编译依赖</a></h2>
<ul>
<li>必要的构建工具</li>
</ul>
<pre><code class="language-bash">apt -y install \
  binutils build-essential libtool texinfo \
  gzip zip unzip patchutils curl git \
  make cmake ninja-build automake bison flex gperf \
  grep sed gawk bc \
  zlib1g-dev libexpat1-dev libmpc-dev \
  libglib2.0-dev libfdt-dev libpixman-1-dev
</code></pre>
<ul>
<li>Clang</li>
</ul>
<pre><code class="language-bash">apt install clang-format clang-tidy clang-tools clang clangd libc++-dev libc++1 libc++abi-dev libc++abi1 libclang-dev libclang1 liblldb-dev libllvm-ocaml-dev libomp-dev libomp5 lld lldb llvm-dev llvm-runtime llvm python3-clang
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="qemu--linux61"><a class="header" href="#qemu--linux61">qemu + linux6.1</a></h1>
<p>linux 6.1 是第一个增加 Rust 驱动开发的 TLS 版本。</p>
<p>本章使用 qemu 内 express-a9 模拟器将 linux 6.1 运行起来。</p>
<h2 id="qemu-1"><a class="header" href="#qemu-1">qemu</a></h2>
<p><a href="https://www.qemu.org/download/">官网</a></p>
<p>我使用的 Debian 仓库自带的版本，直接 apt 安装即可，版本：QEMU emulator version 5.2.0 (Debian 1:5.2+dfsg-11+deb11u2)</p>
<p>也可在官网下载最新版本</p>
<h2 id="编译器"><a class="header" href="#编译器">编译器</a></h2>
<p><a href="https://releases.linaro.org/components/toolchain/binaries/7.5-2019.12/arm-linux-gnueabihf/">arm-linux-gnueabihf-7.5</a></p>
<p>根据开发环境，我下载的 gcc-linaro-7.5.0-2019.12-x86_64_arm-linux-gnueabihf.tar.xz。解压后将 gcc-linaro-7.5.0-2019.12-x86_64_arm-linux-gnueabihf/bin 添加进环境变量，便于后续使用。</p>
<h2 id="linux-内核"><a class="header" href="#linux-内核">linux 内核</a></h2>
<p><a href="https://www.kernel.org/">官方1</a> <a href="https://mirrors.edge.kernel.org/pub/linux/kernel/">官方2</a> <a href="https://mirror.bjtu.edu.cn/kernel/linux/kernel/">国内镜像</a></p>
<p>我选择的 linux-6.1 最高版本 linux-6.1.21，下载、解压后进入目录。</p>
<ol>
<li>导出环境变量：</li>
</ol>
<pre><code class="language-bash">export ARCH=arm
export CROSS_COMPILE=arm-linux-gnueabihf-
</code></pre>
<p>如果没将编译器目录添加进环境变量，还需将编译器可执行文件的完整目录导出：</p>
<pre><code class="language-bash">export PATH=$PATH:/.../gcc-linaro-7.5.0-2019.12-x86_64_arm-linux-gnueabihf/bin
</code></pre>
<ol start="2">
<li>生成默认配置</li>
</ol>
<pre><code class="language-bash">make vexpress_defconfig
</code></pre>
<ol start="3">
<li>编译</li>
</ol>
<pre><code class="language-bash">make zImage dtbs -j4
</code></pre>
<p>编译结束后可以得到:</p>
<pre><code>arch/arm/boot/zImage
arch/arm/boot/dts/vexpress-v2p-ca9.dtb
</code></pre>
<ol start="4">
<li>修改配置
为了方便修改 Makefile 文件：</li>
</ol>
<pre><code class="language-makefile">ARCH          ?= arm
CROSS_COMPILE  = arm-linux-gnueabihf-
</code></pre>
<ol start="5">
<li>运行</li>
</ol>
<pre><code class="language-bash">qemu-system-arm -M vexpress-a9 -m 256M -nographic -kernel zImage -dtb dts/vexpress-v2p-ca9.dtb
</code></pre>
<p>其中： <br>
<strong>-M</strong>：指定 qemu 模拟的设备 <br>
<strong>-m</strong>：指定内存大小 <br>
<strong>-nographic</strong>：无图形化界面 <br>
<strong>-kernel</strong>：指定内核 <br>
<strong>-dtb</strong>：指定设备树</p>
<p>有如下输出：</p>
<pre><code class="language-bash">Booting Linux on physical CPU 0x0
Linux version 6.1.21 (ehe@debian) (arm-linux-gnueabihf-gcc (Linaro GCC 7.5-2019.12) 7.5.0, GNU ld (Linaro_Binutils-2019.12) 2.28.2.20170706) #1 SMP Tue Apr  4 07:12:46 CST 2023
...
---[ end Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(0,0) ]---
</code></pre>
<p>可以看到内核已经运行起来，内核、编译器版本、时间等信息也都显示正确，但最后出现了一个 panic，提示无法挂载根文件系统。</p>
<h2 id="根文件系统"><a class="header" href="#根文件系统">根文件系统</a></h2>
<p>linux 属于宏内核，运行依赖文件系统，需要在启动阶段就加载一个文件系统，将之称为<strong>根文件系统（root fs）</strong>，之后从文件系统中再继续运行其它程序，完成系统的完整启动。</p>
<p>根文件系统的制作方法和工具，广泛使用的3种：</p>
<ul>
<li>busybox</li>
<li>buildroot</li>
<li>yocto</li>
</ul>
<p>这里使用 <strong>busybox</strong>，操作最简单，也最精简。</p>
<p><a href="https://www.busybox.net/">官网</a>下载合适的版本，我这里选择当前最新的稳定版本 BusyBox 1.34.1</p>
<ol>
<li>配置
解压后进入目录，依旧保持之前环境变量，并打开配置界面：</li>
</ol>
<pre><code class="language-bash">export ARCH=arm
export CROSS_COMPILE=arm-linux-gnueabihf-
make menuconfig
</code></pre>
<p>为了保持简单，使用静态库编译：</p>
<pre><code>Settings ---&gt;
    --- Build Options
    [*] Build static binary (no shared libs)
</code></pre>
<ol start="2">
<li>编译并安装</li>
</ol>
<pre><code class="language-bash">make
make install
</code></pre>
<p>因为没有指定 <code>CONFIG_PREFIX</code>，默认安装路径为 busybox 下的 <code>_install</code> 目录。</p>
<ol start="3">
<li>静态创建设备文件</li>
</ol>
<pre><code class="language-bash">cd _install
mkdir dev
cd dev
mknod -m 666 tty1 c 4 1
mknod -m 666 tty2 c 4 2
mknod -m 666 tty3 c 4 3
mknod -m 666 tty4 c 4 4
mknod -m 666 console c 5 1
mknod -m 666 null c 1 3
</code></pre>
<ol start="4">
<li>制作 root fs 镜像
本质是将一块固定大小的存储空间，格式化为某种格式的文件系统，再将 <code>_install</code> 目录内的所有文件都拷贝进去，以下为虚拟设备和实体设备的对比：
a. 创建</li>
</ol>
<pre><code class="language-bash">dd if=/dev/zero of=rootfs.ext4 bs=1M count=16
</code></pre>
<p>其中： <br>
<strong>if</strong>：指定输入文件，这里用 <code>/dev/zero</code> 设备，即输入数据全是 0 <br>
<strong>of</strong>：指定输出文件，这里是 <code>rootfs.ext4</code>，<code>.ext4</code>只是普通字符串，在文件名种说明文件格式 <br>
<strong>bs</strong>：指定块大小，这里是 <code>1M</code> <br>
<strong>count</strong>：指定块数量，这里是 <code>16</code>，即最终创建的存储空间为 <code>16M</code></p>
<blockquote>
<p>对比实体设备的购买SD</p>
</blockquote>
<p>b. 格式化</p>
<pre><code class="language-bash">sudo mkfs.ext4 rootfs.ext4
</code></pre>
<blockquote>
<p>对比实体设备的将SD卡格式化为 ext4 格式。</p>
</blockquote>
<p>c. 挂载</p>
<pre><code class="language-bash">mkdir rootfs
sudo mount -t ext4 rootfs.ext4 rootfs -o loop
</code></pre>
<p>创建一个目录 <code>rootfs</code> 将 rootfs.ext4 挂载上去。</p>
<blockquote>
<p>对比实体设备的插入SD卡，在 /mnt 出现新的存储设备</p>
</blockquote>
<p>d. 复制</p>
<pre><code class="language-bash">sudo cp -rf _install/* rootfs
</code></pre>
<blockquote>
<p>对比实体设备，就是将文件复制进SD卡</p>
</blockquote>
<p>e. 卸载</p>
<pre><code class="language-bash">sudo unmount rootfs
</code></pre>
<blockquote>
<p>对比实体设备的拔除SD卡</p>
</blockquote>
<p>这样 rootfs.ext4 镜像内即有 _install 目录下的所有内容</p>
<h2 id="运行"><a class="header" href="#运行">运行</a></h2>
<pre><code class="language-bash">qemu-system-arm -M vexpress-a9 -m 256M -nographic -kernel zImage -dtb dts/vexpress-v2p-ca9.dtb -sd rootfs.ext4 -append &quot;root=/dev/mmcblk0 rw console=ttyAMA0&quot;
</code></pre>
<p>其中： <br>
<strong>-sd</strong>：指定存储设备为SD，并指定SD镜像为rootfs.ext4 <br>
<strong>-append</strong>：添加附加命令，指定root fs 目录，指定控制台</p>
<pre><code class="language-bash">Booting Linux on physical CPU 0x0
Linux version 6.1.21 (ehe@debian) (arm-linux-gnueabihf-gcc (Linaro GCC 7.5-2019.12) 7.5.0, GNU ld (Linaro_Binutils-2019.12) 2.28.2.20170706) #1 SMP Tue Apr  4 07:12:46 CST 2023
...
Please press Enter to activate this console.
/ # 
</code></pre>
<p>这样就完成里完整的启动，可以执行 busybox 自带的命令。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="qemugdb"><a class="header" href="#qemugdb">qemu+gdb</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="qemuvscode"><a class="header" href="#qemuvscode">qemu+vscode</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="c驱动开发"><a class="header" href="#c驱动开发">C驱动开发</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="最简驱动体验"><a class="header" href="#最简驱动体验">最简驱动体验</a></h1>
<ol>
<li>首先编写模块的必要代码</li>
</ol>
<pre><code class="language-c">// file name: hellomodule.c

#include &lt;linux/module.h&gt;
#include &lt;linux/init.h&gt;
#include &lt;linux/kernel.h&gt;

static int __init hello_init(void) {
    printk(&quot;[ default ] Hello Module Init\n&quot;);
    return 0;
}

static void __exit hello_exit(void) {
    printk(&quot;[ default ] Hello Module Exit\n&quot;);
}

module_init(hello_init);
module_exit(hello_exit);

MODULE_LICENSE(&quot;GPL2&quot;);
MODULE_AUTHOR(&quot;THY&quot;);
MODULE_DESCRIPTION(&quot;hello module&quot;);
MODULE_ALIAS(&quot;test_module&quot;);
</code></pre>
<p>其中：<br></p>
<ul>
<li><code>module_init(hello_init)</code> 用来指定模块的初始化函数，在 <code>insmod</code> 时被调用</li>
<li><code>module_init(hello_exit)</code> 用来指定模块的初始化函数，在 <code>rmmod</code> 时被调用</li>
<li><code>MODULE_***</code> 用来指定模块的相关信息，在 <code>modinfo</code> 时被调用</li>
</ul>
<ol start="2">
<li>编译</li>
</ol>
<pre><code class="language-makefile"># file name: Makefile

KERNRL_DIR = /path/to/src/linux-6.1.21

ARCH := arm
CROSS_COMPILE := arm-linux-gnueabihf-
PATH := $(PATH):/path/to/gcc-linaro-7.5.0-2019.12-x86_64_arm-linux-gnueabihf/bin
export ARCH CROSS_COMPILE PATH

obj-m := hellomodule.o

all:
	$(MAKE) -C $(KERNRL_DIR) M=$(CURDIR) modules

.PHONE: clean

clean:
	$(MAKE) -C $(KERNRL_DIR) M=$(CURDIR) clean

</code></pre>
<p>其中：<br></p>
<ul>
<li><code>KERNRL_DIR</code> 用来指定 linux 源码目录</li>
<li><code>obj-m</code> 用来指定 模块的编译中间文件名，在最终输出 *.ko 文件时用到</li>
<li><code>$(make)</code> 命令中 <code>-C $(KERNRL_DIR)</code> 先进入源码目录，<code>M=$(CURDIR)</code> 指定模块源码目录和输出目录</li>
</ul>
<p>运行 <code>make</code> 后得到 <code>hellomodule.ko</code> 文件，将之放入根文件系统中。</p>
<ol start="2">
<li>测试模块
启动虚拟机，加载模块：</li>
</ol>
<pre><code class="language-bash">/ # insmod hellomodule.ko 
hellomodule: loading out-of-tree module taints kernel.
hellomodule: module license 'GPL2' taints kernel.
Disabling lock debugging due to kernel taint
[ default ] Hello Module Init
</code></pre>
<p>可以看到有 <code>hello_init()</code> 中的输出内容，表明初始化函数被执行。</p>
<p>卸载模块：</p>
<pre><code class="language-bash">/ # rmmod hellomodule.ko 
[ default ] Hello Module Exit
</code></pre>
<p>可以看到有 <code>hello_exit()</code> 中的输出内容，表明卸载函数被执行。</p>
<p>查看模块信息：</p>
<pre><code class="language-bash">/ # modinfo hellomodule.ko 
filename:       hellomodule.ko
author:         THY
description:    hello module
license:        GPL2
alias:          test_module
depends:        
vermagic:       6.1.21 SMP mod_unload ARMv7 p2v8 
</code></pre>
<p>可以看到 <code>MODULE_***</code> 相关宏内的信息。</p>
<blockquote>
<p>注意：</p>
<p><code>modinfo</code> 执行依赖 <code>modules.dep</code> 文件，该文件在 <code>/path/to/src/linux-6.1.21/lib/modules/6.1.21/</code> 内，可以将该目录下 <code>modules.*</code> 文件都复制到根文件系统的指定目录内。</p>
<pre><code class="language-bash">/ # modinfo hellomodule.ko 
modinfo: can't open '/lib/modules/6.1.21/modules.dep': No such file or directory
</code></pre>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="其它"><a class="header" href="#其它">其它</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="c驱动开发-1"><a class="header" href="#c驱动开发-1">C驱动开发</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="最简驱动体验-1"><a class="header" href="#最简驱动体验-1">最简驱动体验</a></h1>
<p>如果在 Docker 中做开发，先参考 <a href="./env_docker.html">Docker 安装</a> 和 <a href="./env_docker_config.html">Docker 配置</a> 完成环境的搭建，其它内容参考 <a href="./env_01.html">qemu + linux6.1</a>，这边只介绍 rust 相关的新增内容。</p>
<h2 id="编译准备"><a class="header" href="#编译准备">编译准备</a></h2>
<p>这边选用当前 linux 6.1 的最高版本 <a href="https://cdn.kernel.org/pub/linux/kernel/v6.x/linux-6.1.25.tar.xz">6.1.25</a>。</p>
<p>下载、解压后进入，查看 <code>Documentation/rust/quick-start.rst</code> 可以看到开启内核里Rust支持的一些先决条件：</p>
<pre><code class="language-bash"># 1. 指定 rustc 版本：
rustup override set $(scripts/min-tool-version.sh rustc)

# 2. 添加 rust 源码
rustup component add rust-src

# 3. libclang：从 https://releases.llvm.org/download.html 下载最新编译好的内容，将 bin 文件夹加入环境变量

# 4. 指定 binggen 版本：
cargo install --locked --version $(scripts/min-tool-version.sh bindgen) bindgen

# 5. 其余内容在安装 rust 时都已自动安装

# 6. 检查依赖是否满足
make LLVM=1 rustavailable
</code></pre>
<h2 id="内核配置"><a class="header" href="#内核配置">内核配置</a></h2>
<pre><code class="language-bash"># 1. 选择基本环境，当前版本内核支持的并不宽泛，x86_64 和 arm64（aarch64）的限制少： 
make x86_64_defconfig

# 2.1 General setup -&gt;
#       [*] Rust support
# 2.2 Kernel hacking -&gt;
#       [*] Sample kernel code -&gt;
#           [*] Rust samples -&gt;
#               [*] Minimal
make LLVM=1 menuconfig

# 3. 编译
make LLVM=1
</code></pre>
<p>其中 2.1 是使能内核的 Rust 支持， 2.2 是将内核自带的一个最简模块示例代码编译进内核镜像，启动内核是可以自动加载。</p>
<h2 id="根文件系统制作"><a class="header" href="#根文件系统制作">根文件系统制作</a></h2>
<p>在 <a href="./env_01.html">qemu + linux6.1</a> 中介绍了根文件系统的详细步骤，这里因为 linux 选择了 <code>x86_64_defconfig</code> 使用另一种简单的方式，将其写为了脚本，方便使用</p>
<pre><code class="language-bash">#!/bin/sh
busybox_folder=&quot;/download/busybox-1.34.1&quot;
rootfs=&quot;rootfs&quot;
rootfs_img=$PWD&quot;/rootfs.img&quot;

echo $base_path
if [ ! -d $rootfs ]; then #判断文件是否存在
	mkdir $rootfs
fi
cp $busybox_folder/_install/*  $rootfs/ -rf
cd $rootfs
if [ ! -d proc ] &amp;&amp; [ ! -d sys ] &amp;&amp; [ ! -d dev ] &amp;&amp; [ ! -d etc/init.d ]; then
	mkdir proc sys dev etc etc/init.d
fi
 
if [ -f etc/init.d/rcS ]; then
	rm etc/init.d/rcS
fi
echo &quot;#!/bin/sh&quot; &gt; etc/init.d/rcS
echo &quot;mount -t proc none /proc&quot; &gt;&gt; etc/init.d/rcS
echo &quot;mount -t sysfs none /sys&quot; &gt;&gt; etc/init.d/rcS
echo &quot;/sbin/mdev -s&quot; &gt;&gt; etc/init.d/rcS
chmod +x etc/init.d/rcS
if [ -f $rootfs_img ]; then
	rm $rootfs_img
fi
find . | cpio -o --format=newc &gt; $rootfs_img
</code></pre>
<p>执行脚本后即可在当前目录得到 <code>rootfs.img</code> 文件。</p>
<h2 id="启动内核"><a class="header" href="#启动内核">启动内核</a></h2>
<p>为了方便使用，将启动命令写进了 Makefile：</p>
<pre><code class="language-makefile">KERNEL_IMG = /download/linux-6.1.25/arch/x86_64/boot/bzImage
QEMU = qemu-system-x86_64
ROOTFS_IMG = rootfs.img

default:
	$(QEMU) -kernel $(KERNEL_IMG) -append &quot;root=/dev/ram rdinit=sbin/init console=ttyS0&quot; -nographic -initrd $(ROOTFS_IMG)

</code></pre>
<p>执行 <code>make</code> 指令即可启动内核：</p>
<pre><code>[    0.000000] Linux version 6.2.0 (root@5deb884f5933) (gcc (Debian 10.2.1-6) 10.2.1 20210110, GNU ld (GNU Binutils for Debian) 2.35.2) #1 SMP PREEMPT_DYNAMIC 3
[    0.000000] Command line: root=/dev/ram rdinit=sbin/init console=ttyS0
...
[    1.686751] usbhid: USB HID core driver
[    1.689337] rust_minimal: Rust minimal sample (init)
[    1.689571] rust_minimal: Am I built-in? true
[    1.692888] Initializing XFRM netlink socket
...
Please press Enter to activate this console.
/ # 
</code></pre>
<p>可以看到 [rust_minimal] 模块在挂载时的日志内容。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="最简模块"><a class="header" href="#最简模块">最简模块</a></h1>
<p>这一章介绍如何在 linux 源码目录外编写 <code>.ko</code> 模块，用于动态加载、卸载。</p>
<h2 id="模块代码"><a class="header" href="#模块代码">模块代码</a></h2>
<p>依然是内核中的代码，只是将其复制出来：</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// SPDX-License-Identifier: GPL-2.0

//! Rust minimal sample.

use kernel::prelude::*;

module! {
    type: RustMinimal,
    name: b&quot;rust_minimal&quot;,
    author: b&quot;Rust for Linux Contributors&quot;,
    description: b&quot;Rust minimal sample&quot;,
    license: b&quot;GPL&quot;,
}

struct RustMinimal {
    numbers: Vec&lt;i32&gt;,
}

impl kernel::Module for RustMinimal {
    fn init(_module: &amp;'static ThisModule) -&gt; Result&lt;Self&gt; {
        pr_info!(&quot;Rust minimal sample (init)\n&quot;);
        pr_info!(&quot;Am I built-in? {}\n&quot;, !cfg!(MODULE));

        let mut numbers = Vec::new();
        numbers.try_push(72)?;
        numbers.try_push(108)?;
        numbers.try_push(200)?;

        Ok(RustMinimal { numbers })
    }
}

impl Drop for RustMinimal {
    fn drop(&amp;mut self) {
        pr_info!(&quot;My numbers are {:?}\n&quot;, self.numbers);
        pr_info!(&quot;Rust minimal sample (exit)\n&quot;);
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>Makefile:</p>
<pre><code class="language-makefile"># SPDX-License-Identifier: GPL-2.0

KDIR ?= /download/linux-6.1.25 
# KDIR ?= /download/linux-r4l

obj-m := rust_minimal.o

default:
	$(MAKE) -C $(KDIR) M=$$PWD modules

default1:
	$(MAKE) -C $(KDIR) M=$$PWD LLVM=1 CLIPPY=1 modules
</code></pre>
<p>实际编译时发现 <code>LLVM=1 CLIPPY=1</code> 有没有都可以，<code>modules</code> 一定要有。</p>
<p>执行 <code>make</code> 命令后可以在当前文件夹得到 <code>rust_minimal.ko</code> 文件，将其复制到根文件系统目录，重新制作根文件系统镜像。</p>
<h2 id="动态加载卸载模块"><a class="header" href="#动态加载卸载模块">动态加载、卸载模块</a></h2>
<p>启动完成后可以在根目录看到 ko 模块：</p>
<pre><code class="language-bash"># 1. 查看模块文件
ls
bin              linuxrc          rust_minimal.ko  usr
dev              proc             sbin
etc              root             sys

# 2. 加载模块
insmod rust_minimal.ko
[    8.093904] rust_minimal: loading out-of-tree module taints kernel.
[    8.098383] rust_minimal: Rust minimal sample (init)
[    8.098497] rust_minimal: Am I built-in? false

# 3. 卸载模块
rmmod rust_minimal.ko 
[   51.045758] rust_minimal: My numbers are [72, 108, 200]
[   51.046395] rust_minimal: Rust minimal sample (exit)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="linux-fujita--e1000"><a class="header" href="#linux-fujita--e1000">linux-fujita + e1000</a></h1>
<p>复现用 Rust 编写的 e1000 网卡驱动。</p>
<h2 id="linux"><a class="header" href="#linux">Linux</a></h2>
<p>使用开发者 <a href="https://github.com/fujita/linux/tree/rust-e1000">fujita</a> 开发维护的 linux 内核源码，这里增加了 PCI、DMA、NIC 等网络API的抽象。</p>
<blockquote>
<p>！注意！</p>
<p>如果是自行进入 github.com/fujita/linux，一定要切换到 <code>rust-e1000</code> 分支！</p>
</blockquote>
<pre><code class="language-bash"># 1. 选择基本环境 
make x86_64_defconfig

# 2.1 General setup -&gt;
#       [*] Rust support
# 2.2 Kernel hacking -&gt;
#       [*] Sample kernel code -&gt;
#           [*] Rust samples -&gt;
#               [*] Minimal
# 2.3 Device Driver -&gt;
#       Network device support -&gt;
#           Ethernet driver support -&gt;
#               Intel devices -&gt;
#                   &lt;*&gt; Intel(R) PRO/100+ support
#                   &lt;M&gt; Intel(R) PRO/1000 Gigabit Ethernet support
#                   &lt;*&gt; Intel(R) PRO/1000 PCI-Express Gigabit Ethernet support
make LLVM=1 menuconfig

# 3. 编译
make LLVM=1 -j8
</code></pre>
<p>其中：</p>
<p>2.3 是将原本默认选择的e1000网卡驱动选择去除，这里为了避免其它编译依赖问题，查看 Kconfig 后将 <code>Intel(R) PRO/1000 Gigabit Ethernet support</code> 选为 M 模式。</p>
<h2 id="e1000-fujita"><a class="header" href="#e1000-fujita">e1000-fujita</a></h2>
<p>这是开发者 <a href="https://github.com/fujita/rust-e1000">fujita</a> 的 e1000 驱动，如其 README 所述：<code>This driver works on QEMU, howerver nothing else works.</code>，纯粹为了验证可以编译ko模块。</p>
<ol>
<li>
<p>下载、传入 Docker 后进入目录，执行 <code>make KDIR=/your/linux-rust-e1000/path LLVM=1</code>，其中<code>/your/linux-rust-e1000/path</code> 即<a href="rust_fujita_e1000.html#linux">前面</a>编译的 linux 目录，编译完成后得到 <code>rust_e1000.ko</code> 文件，<a href="./rust_01.html#%E6%A0%B9%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%88%B6%E4%BD%9C">重新制作</a>根文件系统镜像</p>
</li>
<li>
<p>挂载模块、<a href="./rust_01.html#%E5%90%AF%E5%8A%A8%E5%86%85%E6%A0%B8">启动模块</a></p>
</li>
</ol>
<pre><code>[    0.000000] Linux version 6.1.0-rc1 (root@183b0e7b45ae) (Debian clang version 11.0.1-2, LLD 11.0.1) #1 SMP PREEMPT_DYNAMIC Wed May 10 13:05:54 UTC 2023
...
[    1.711355] rust_minimal: Rust minimal sample (init)
[    1.711671] rust_minimal: Am I built-in? true
Please press Enter to activate this console. 
/ # ls
bin                linuxrc            root               sbin
dev                proc               rust_e1000.ko      sys
etc                usr
/ # insmod rust_e1000.ko 
[  422.320006] rust_e1000: loading out-of-tree module taints kernel.
[  422.327016] insmod (79) used greatest stack depth: 13320 bytes left
</code></pre>
<p>可以看到模块被加载的日志输出。</p>
<h2 id="e1000-myrfy001"><a class="header" href="#e1000-myrfy001">e1000-myrfy001</a></h2>
<p>这是开发者 <a href="https://github.com/myrfy001/r4l-e1000">myrfy001</a> 的 e1000 驱动，具备一定的网络能力，如 <code>ping</code>。</p>
<p>参考 <a href="rust_fujita_e1000.html#e1000-fujita">e1000-fujita</a> 完成驱动模块的加载，或者使用以下脚本：</p>
<pre><code class="language-bash">set -e

# Build the kernel module
make -C /download/linux-rust-e1000/ M=$PWD LLVM=1 CLIPPY=1

# Copy the build kernel module to the rootfs folder, there should be a usable busybox at `rootfs` folder
cp ./r4l_e1000_demo.ko ../rootfs

# Build the rootfs image
pushd ../rootfs &amp;&amp; \
find . | cpio -o --format=newc &gt; ../rootfs.img &amp;&amp; \
popd


# Run QEMU to test the kernel, the network traffic will be dumped to `dump.dat` and you can use wireshark to explore the result.
qemu-system-x86_64 \
-netdev &quot;user,id=eth0&quot; \
-device &quot;e1000,netdev=eth0&quot; \
-object &quot;filter-dump,id=eth0,netdev=eth0,file=dump.dat&quot; \
-kernel /download/linux-rust-e1000/arch/x86/boot/bzImage \
-append &quot;root=/dev/ram rdinit=sbin/init console=ttyS0&quot; \
-nographic \
-initrd ../rootfs.img
</code></pre>
<p>启动后执行以下命令：</p>
<pre><code class="language-bash"># 1. 加载 ko 驱动模块
insmod r4l_e1000_demo.ko

# 2. 使能网卡
ip link set eth0 up

# 3. 设置 ip 和掩码
ip addr add 10.0.2.15/255.255.255.0 dev eth0

# 4. 10.0.2.2 是 qemu 的内部网关(防火墙、DHCP 服务器)
ping 10.0.2.2

# 5. 192.168.0.113 是运行 docker 的宿主机，此时还 ping 不通，显示网络无法到达
ping 192.168.0.113

# 6. 设置路由（网关）
ip route add default via 10.0.2.2

# 7. 192.168.0.113 此时可以 ping 通
ping 192.168.0.113

# 8. 百度 ip 110.242.68.66
ping 110.242.68.66
</code></pre>
<p>输出如下：</p>
<pre><code>[    0.000000] Linux version 6.1.0-rc1 (root@7384ad8b51fb) (Debian clang version 11.0.1-2, LLD 11.0.1) #1 SMP PREEMPT_DYNAMIC Wed May 10 15:39:37 UTC 2023
[    0.000000] Command line: root=/dev/ram rdinit=sbin/init console=ttyS0
...
Please press Enter to activate this console.
/ # insmod r4l_e1000_demo.ko
[   19.885701] r4l_e1000_demo: loading out-of-tree module taints kernel.
[   19.891582] r4l_e1000_demo: Rust for linux e1000 driver demo (init)
[   19.891961] r4l_e1000_demo: Rust for linux e1000 driver demo (probe): None
[   20.053107] ACPI: \_SB_.LNKC: Enabled at IRQ 11
[   20.074398] r4l_e1000_demo: Rust for linux e1000 driver demo (net device get_stats64)
[   20.076238] insmod (79) used greatest stack depth: 10792 bytes left
/ # ip link set eth0 up
[   74.903901] r4l_e1000_demo: Rust for linux e1000 driver demo (net device open)
[   74.906640] r4l_e1000_demo: Rust for linux e1000 driver demo (net device get_stats64)
[   74.907998] IPv6: ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready
[   74.911179] r4l_e1000_demo: Rust for linux e1000 driver demo (net device get_stats64)
/ # ip addr add 10.0.2.15/255.255.255.0 dev eth0
[   94.348826] r4l_e1000_demo: Rust for linux e1000 driver demo (net device get_stats64)
[   94.350660] r4l_e1000_demo: Rust for linux e1000 driver demo (net device get_stats64)
/ # ping 10.0.2.2
PING 10.0.2.2 (10.0.2.2): 56 data bytes
64 bytes from 10.0.2.2: seq=0 ttl=255 time=7.832 ms
64 bytes from 10.0.2.2: seq=1 ttl=255 time=2.218 ms
64 bytes from 10.0.2.2: seq=2 ttl=255 time=2.149 ms
64 bytes from 10.0.2.2: seq=3 ttl=255 time=1.937 ms
^C
--- 10.0.2.2 ping statistics ---
4 packets transmitted, 4 packets received, 0% packet loss
round-trip min/avg/max = 1.937/3.534/7.832 ms
/ # ping 192.168.0.113
PING 192.168.0.113 (192.168.0.113): 56 data bytes
ping: sendto: Network is unreachable
/ # ip route add default via 10.0.2.2
/ # ping 192.168.0.113
PING 192.168.0.113 (192.168.0.113): 56 data bytes
64 bytes from 192.168.0.113: seq=0 ttl=255 time=0.540 ms
64 bytes from 192.168.0.113: seq=1 ttl=255 time=1.968 ms
64 bytes from 192.168.0.113: seq=2 ttl=255 time=2.016 ms
64 bytes from 192.168.0.113: seq=3 ttl=255 time=2.369 ms
^C
--- 192.168.0.113 ping statistics ---
5 packets transmitted, 5 packets received, 0% packet loss
round-trip min/avg/max = 0.540/1.822/2.369 ms
/ # ping 110.242.68.66
PING 110.242.68.66 (110.242.68.66): 56 data bytes
64 bytes from 110.242.68.66: seq=0 ttl=255 time=33.533 ms
64 bytes from 110.242.68.66: seq=1 ttl=255 time=32.218 ms
64 bytes from 110.242.68.66: seq=2 ttl=255 time=32.161 ms
64 bytes from 110.242.68.66: seq=3 ttl=255 time=31.477 ms
^C
--- 110.242.68.66 ping statistics ---
4 packets transmitted, 4 packets received, 0% packet loss
round-trip min/avg/max = 31.477/32.347/33.533 ms
</code></pre>
<h2 id="笔记"><a class="header" href="#笔记">笔记</a></h2>
<ol>
<li>QEMU 网络模型</li>
</ol>
<pre><code>guest (10.0.2.15)  &lt;------&gt;  Firewall/DHCP server &lt;-----&gt; Internet
                      |          (10.0.2.2)
                      |
                      ----&gt;  DNS server (10.0.2.3)
                      |
                      ----&gt;  SMB server (10.0.2.4)
</code></pre>
<p>详见<a href="https://www.qemu.org/docs/master/system/devices/net.html">官方文档</a></p>
<ol start="2">
<li>QEMU与宿主机之间的通信机制</li>
</ol>
<p>QEMU提供了四种网络通信模式：TAP、user、Sockets和VDE。利用user模式可以实现虚拟机和宿主机之间的通信且较为简单易行，在这种通信模式中，虚拟机处于10.0.2.*网段，该网段通过一个NAT服务器与外界通信，NAT服务器的地址是10.0.2.2，虚拟机的IP地址从10.0.2.15开始分配。<br>
———————————————— <br>
版权声明：本文为CSDN博主「小呀小二笙」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
原文链接：<a>https://blog.csdn.net/qq_38790716/article/details/85019030</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="stm32h743-以太网外设初始化分析"><a class="header" href="#stm32h743-以太网外设初始化分析">STM32H743 以太网外设初始化分析</a></h1>
<p>因为目标板与 STM32H743 使用的相同以太网 MAC，而 STM32H743 相对熟悉，并且简单，所以先从 STM32H743 这款芯片的 C 代码开始分析，了解 MAC 的初始化流程、工作原理。</p>
<p>参考资料：</p>
<ul>
<li>STM32H7-HAL 库</li>
<li>STM32H7x3 参考手册 RM0433</li>
<li>RT-Thread 设备驱动框架的以太网部分</li>
</ul>
<h2 id="结构体定义"><a class="header" href="#结构体定义">结构体定义</a></h2>
<p>有几个重要的结构体:</p>
<h3 id="eth_inittypedef"><a class="header" href="#eth_inittypedef">ETH_InitTypeDef</a></h3>
<p>该结构体用于描述 MAC 使用的外部资源信息，在初始化时参与配置 MAC 寄存器。</p>
<pre><code class="language-c">/** 
  * @brief  ETH Init Structure definition  
  */
typedef struct
{
   
  uint8_t                     *MACAddr;         /*!&lt; MAC Address of used Hardware: must be pointer on an array of 6 bytes */
  	
  ETH_MediaInterfaceTypeDef   MediaInterface;   /*!&lt; Selects the MII interface or the RMII interface. */

  ETH_DMADescTypeDef          *TxDesc;          /*!&lt; Provides the address of the first DMA Tx descriptor in the list */
  
  ETH_DMADescTypeDef          *RxDesc;          /*!&lt; Provides the address of the first DMA Rx descriptor in the list */
  
  uint32_t                    RxBuffLen;        /*!&lt; Provides the length of Rx buffers size */

}ETH_InitTypeDef;
</code></pre>
<h3 id="eth_macconfigtypedef"><a class="header" href="#eth_macconfigtypedef">ETH_MACConfigTypeDef</a></h3>
<p>该结构体可以认为是 MAC 配置寄存器中，所有支持功能的描述，作为 <code>ETH_SetMACConfig()</code> 的入口参数，将成员变量的值写进对应寄存器的位域中。</p>
<pre><code class="language-c">/** 
  * @brief  ETH MAC Configuration Structure definition  
  */
typedef struct
{
  uint32_t         SourceAddrControl;           /*!&lt; Selects the Source Address Insertion or Replacement Control.                                                           
                                                     This parameter can be a value of @ref ETH_Source_Addr_Control */                  

  FunctionalState  ChecksumOffload;             /*!&lt; Enables or Disable the checksum checking for received packet payloads TCP, UDP or ICMP headers */    

  uint32_t         InterPacketGapVal;           /*!&lt; Sets the minimum IPG between Packet during transmission.
                                                     This parameter can be a value of @ref ETH_Inter_Packet_Gap */   

  FunctionalState  GiantPacketSizeLimitControl; /*!&lt; Enables or disables the Giant Packet Size Limit Control. */  

  FunctionalState  Support2KPacket;             /*!&lt; Enables or disables the IEEE 802.3as Support for 2K length Packets */ 

  FunctionalState  CRCStripTypePacket;          /*!&lt; Enables or disables the CRC stripping for Type packets.*/ 

  FunctionalState  AutomaticPadCRCStrip;        /*!&lt; Enables or disables  the Automatic MAC Pad/CRC Stripping.*/ 
																													 
  FunctionalState  Watchdog;                    /*!&lt; Enables or disables the Watchdog timer on Rx path
                                                           When enabled, the MAC allows no more then 2048 bytes to be received.
                                                           When disabled, the MAC can receive up to 16384 bytes. */  

  FunctionalState  Jabber;                      /*!&lt; Enables or disables Jabber timer on Tx path
                                                           When enabled, the MAC allows no more then 2048 bytes to be sent.
                                                           When disabled, the MAC can send up to 16384 bytes. */

  FunctionalState  JumboPacket;                 /*!&lt; Enables or disables receiving Jumbo Packet
                                                           When enabled, the MAC allows jumbo packets of 9,018 bytes
                                                           without reporting a giant packet error */

  uint32_t         Speed;                       /*!&lt; Sets the Ethernet speed: 10/100 Mbps.
                                                           This parameter can be a value of @ref ETH_Speed */

  uint32_t         DuplexMode;                  /*!&lt; Selects the MAC duplex mode: Half-Duplex or Full-Duplex mode
                                                           This parameter can be a value of @ref ETH_Duplex_Mode */

  FunctionalState  LoopbackMode;                /*!&lt; Enables or disables the loopback mode */

  FunctionalState  CarrierSenseBeforeTransmit;  /*!&lt; Enables or disables the Carrier Sense Before Transmission in Full Duplex Mode. */

  FunctionalState  ReceiveOwn;                  /*!&lt; Enables or disables the Receive Own in Half Duplex mode. */  

  FunctionalState  CarrierSenseDuringTransmit;  /*!&lt; Enables or disables the Carrier Sense During Transmission in the Half Duplex mode */

  FunctionalState  RetryTransmission;           /*!&lt; Enables or disables the MAC retry transmission, when a collision occurs in Half Duplex mode.*/

  uint32_t         BackOffLimit;                /*!&lt; Selects the BackOff limit value.
                                                        This parameter can be a value of @ref ETH_Back_Off_Limit */

  FunctionalState  DeferralCheck;               /*!&lt; Enables or disables the deferral check function in Half Duplex mode. */

  uint32_t         PreambleLength;              /*!&lt; Selects or not the Preamble Length for Transmit packets (Full Duplex mode).
                                                           This parameter can be a value of @ref ETH_Preamble_Length */ 
                                                           
  FunctionalState  UnicastSlowProtocolPacketDetect;   /*!&lt; Enable or disables the Detection of Slow Protocol Packets with unicast address. */   

  FunctionalState  SlowProtocolDetect;          /*!&lt; Enable or disables the Slow Protocol Detection. */   

  FunctionalState  CRCCheckingRxPackets;        /*!&lt; Enable or disables the CRC Checking for Received Packets. */   

  uint32_t         GiantPacketSizeLimit;        /*!&lt; Specifies the packet size that the MAC will declare it as Giant, If it's size is 
	                                                  greater than the value programmed in this field in units of bytes 
                                                          This parameter must be a number between Min_Data = 0x618 (1518 byte) and Max_Data = 0x3FFF (32 Kbyte)*/                                                          
 
  FunctionalState  ExtendedInterPacketGap;      /*!&lt; Enable or disables the extended inter packet gap. */ 
  
  uint32_t         ExtendedInterPacketGapVal;   /*!&lt; Sets the Extended IPG between Packet during transmission.
                                                           This parameter can be a value from 0x0 to 0xFF */ 
  
  FunctionalState  ProgrammableWatchdog;        /*!&lt; Enable or disables the Programmable Watchdog.*/
	
  uint32_t         WatchdogTimeout;             /*!&lt; This field is used as watchdog timeout for a received packet
                                                        This parameter can be a value of @ref ETH_Watchdog_Timeout */                                                            

   uint32_t        PauseTime;                   /*!&lt; This field holds the value to be used in the Pause Time field in the transmit control packet. 
                                                   This parameter must be a number between Min_Data = 0x0 and Max_Data = 0xFFFF */

  FunctionalState  ZeroQuantaPause;             /*!&lt; Enable or disables the automatic generation of Zero Quanta Pause Control packets.*/  

  uint32_t         PauseLowThreshold;           /*!&lt; This field configures the threshold of the PAUSE to be checked for automatic retransmission of PAUSE Packet.
                                                   This parameter can be a value of @ref ETH_Pause_Low_Threshold */

  FunctionalState  TransmitFlowControl;         /*!&lt; Enables or disables the MAC to transmit Pause packets in Full Duplex mode
                                                   or the MAC back pressure operation in Half Duplex mode */

  FunctionalState  UnicastPausePacketDetect;    /*!&lt; Enables or disables the MAC to detect Pause packets with unicast address of the station */
  
  FunctionalState  ReceiveFlowControl;          /*!&lt; Enables or disables the MAC to decodes the received Pause packet  
                                                  and disables its transmitter for a specified (Pause) time */
																													                                                        	 
  uint32_t         TransmitQueueMode;           /*!&lt; Specifies the Transmit Queue operating mode.
                                                      This parameter can be a value of @ref ETH_Transmit_Mode */ 

  uint32_t         ReceiveQueueMode;            /*!&lt; Specifies the Receive Queue operating mode.
                                                             This parameter can be a value of @ref ETH_Receive_Mode */

  FunctionalState  DropTCPIPChecksumErrorPacket; /*!&lt; Enables or disables Dropping of TCPIP Checksum Error Packets. */ 

  FunctionalState  ForwardRxErrorPacket;        /*!&lt; Enables or disables  forwarding Error Packets. */ 

  FunctionalState  ForwardRxUndersizedGoodPacket;  /*!&lt; Enables or disables  forwarding Undersized Good Packets.*/ 
} ETH_MACConfigTypeDef;
</code></pre>
<h3 id="eth_typedef"><a class="header" href="#eth_typedef">ETH_TypeDef</a></h3>
<p>片内以太网外设的寄存器映射，其中包含以下寄存器映射：</p>
<ul>
<li>DMA 寄存器</li>
<li>MTL 寄存器</li>
<li>MAC 寄存器</li>
</ul>
<pre><code class="language-c">/**
  * @brief Ethernet MAC
  */
typedef struct
{
  __IO uint32_t MACCR;
  __IO uint32_t MACECR;
  __IO uint32_t MACPFR;
  __IO uint32_t MACWTR;
  __IO uint32_t MACHT0R;
  __IO uint32_t MACHT1R;
  uint32_t      RESERVED1[14];
  __IO uint32_t MACVTR;
  uint32_t      RESERVED2;
  __IO uint32_t MACVHTR;
  uint32_t      RESERVED3;
  __IO uint32_t MACVIR;
  __IO uint32_t MACIVIR;
  uint32_t      RESERVED4[2];
  __IO uint32_t MACTFCR;
  uint32_t      RESERVED5[7];
  __IO uint32_t MACRFCR;
  uint32_t      RESERVED6[7];
  __IO uint32_t MACISR;
  __IO uint32_t MACIER;
  __IO uint32_t MACRXTXSR;
  uint32_t      RESERVED7;
  __IO uint32_t MACPCSR;
  __IO uint32_t MACRWKPFR;
  uint32_t      RESERVED8[2];
  __IO uint32_t MACLCSR;
  __IO uint32_t MACLTCR;
  __IO uint32_t MACLETR;
  __IO uint32_t MAC1USTCR;
  uint32_t      RESERVED9[12];
  __IO uint32_t MACVR;
  __IO uint32_t MACDR;
  uint32_t      RESERVED10;
  __IO uint32_t MACHWF0R;
  __IO uint32_t MACHWF1R;
  __IO uint32_t MACHWF2R;
  uint32_t      RESERVED11[54];
  __IO uint32_t MACMDIOAR;
  __IO uint32_t MACMDIODR;
  uint32_t      RESERVED12[2];
  __IO uint32_t MACARPAR;
  uint32_t      RESERVED13[59];
  __IO uint32_t MACA0HR;
  __IO uint32_t MACA0LR;
  __IO uint32_t MACA1HR;
  __IO uint32_t MACA1LR;
  __IO uint32_t MACA2HR;
  __IO uint32_t MACA2LR;
  __IO uint32_t MACA3HR;
  __IO uint32_t MACA3LR;
  uint32_t      RESERVED14[248];
  __IO uint32_t MMCCR;
  __IO uint32_t MMCRIR;
  __IO uint32_t MMCTIR;
  __IO uint32_t MMCRIMR;
  __IO uint32_t MMCTIMR;
  uint32_t      RESERVED15[14];
  __IO uint32_t MMCTSCGPR;
  __IO uint32_t MMCTMCGPR;
  uint32_t      RESERVED16[5];
  __IO uint32_t MMCTPCGR;
  uint32_t      RESERVED17[10];
  __IO uint32_t MMCRCRCEPR;
  __IO uint32_t MMCRAEPR;
  uint32_t      RESERVED18[10];
  __IO uint32_t MMCRUPGR;
  uint32_t      RESERVED19[9];
  __IO uint32_t MMCTLPIMSTR;
  __IO uint32_t MMCTLPITCR;
  __IO uint32_t MMCRLPIMSTR;
  __IO uint32_t MMCRLPITCR;
  uint32_t      RESERVED20[65];
  __IO uint32_t MACL3L4C0R;
  __IO uint32_t MACL4A0R;
  uint32_t      RESERVED21[2];
  __IO uint32_t MACL3A0R0R;
  __IO uint32_t MACL3A1R0R;
  __IO uint32_t MACL3A2R0R;
  __IO uint32_t MACL3A3R0R;
  uint32_t      RESERVED22[4];
  __IO uint32_t MACL3L4C1R;
  __IO uint32_t MACL4A1R;
  uint32_t      RESERVED23[2];
  __IO uint32_t MACL3A0R1R;
  __IO uint32_t MACL3A1R1R;
  __IO uint32_t MACL3A2R1R;
  __IO uint32_t MACL3A3R1R;
  uint32_t      RESERVED24[108];
  __IO uint32_t MACTSCR;
  __IO uint32_t MACSSIR;
  __IO uint32_t MACSTSR;
  __IO uint32_t MACSTNR;
  __IO uint32_t MACSTSUR;
  __IO uint32_t MACSTNUR;
  __IO uint32_t MACTSAR;
  uint32_t      RESERVED25;
  __IO uint32_t MACTSSR;
  uint32_t      RESERVED26[3];
  __IO uint32_t MACTTSSNR;
  __IO uint32_t MACTTSSSR;
  uint32_t      RESERVED27[2];
  __IO uint32_t MACACR;
  uint32_t      RESERVED28;
  __IO uint32_t MACATSNR;
  __IO uint32_t MACATSSR;
  __IO uint32_t MACTSIACR;
  __IO uint32_t MACTSEACR;
  __IO uint32_t MACTSICNR;
  __IO uint32_t MACTSECNR;
  uint32_t      RESERVED29[4];
  __IO uint32_t MACPPSCR;
  uint32_t      RESERVED30[3];
  __IO uint32_t MACPPSTTSR;
  __IO uint32_t MACPPSTTNR;
  __IO uint32_t MACPPSIR;
  __IO uint32_t MACPPSWR;
  uint32_t      RESERVED31[12];
  __IO uint32_t MACPOCR;
  __IO uint32_t MACSPI0R;
  __IO uint32_t MACSPI1R;
  __IO uint32_t MACSPI2R;
  __IO uint32_t MACLMIR;
  uint32_t      RESERVED32[11];
  __IO uint32_t MTLOMR;
  uint32_t      RESERVED33[7];
  __IO uint32_t MTLISR;
  uint32_t      RESERVED34[55];
  __IO uint32_t MTLTQOMR;
  __IO uint32_t MTLTQUR;
  __IO uint32_t MTLTQDR;
  uint32_t      RESERVED35[8];
  __IO uint32_t MTLQICSR;
  __IO uint32_t MTLRQOMR;
  __IO uint32_t MTLRQMPOCR;
  __IO uint32_t MTLRQDR;
  uint32_t      RESERVED36[177];
  __IO uint32_t DMAMR;
  __IO uint32_t DMASBMR;
  __IO uint32_t DMAISR;
  __IO uint32_t DMADSR;
  uint32_t      RESERVED37[60];
  __IO uint32_t DMACCR;
  __IO uint32_t DMACTCR;
  __IO uint32_t DMACRCR;
  uint32_t      RESERVED38[2];
  __IO uint32_t DMACTDLAR;
  uint32_t      RESERVED39;
  __IO uint32_t DMACRDLAR;
  __IO uint32_t DMACTDTPR;
  uint32_t      RESERVED40;
  __IO uint32_t DMACRDTPR;
  __IO uint32_t DMACTDRLR;
  __IO uint32_t DMACRDRLR;
  __IO uint32_t DMACIER;
  __IO uint32_t DMACRIWTR;
__IO uint32_t DMACSFCSR;
  uint32_t      RESERVED41;
  __IO uint32_t DMACCATDR;
  uint32_t      RESERVED42;
  __IO uint32_t DMACCARDR;
  uint32_t      RESERVED43;
  __IO uint32_t DMACCATBR;
  uint32_t      RESERVED44;
  __IO uint32_t DMACCARBR;
  __IO uint32_t DMACSR;
uint32_t      RESERVED45[2];
__IO uint32_t DMACMFCR;
}ETH_TypeDef;
</code></pre>
<h2 id="stm32-hal-中-eth-初始化"><a class="header" href="#stm32-hal-中-eth-初始化">STM32-HAL 中 eth 初始化</a></h2>
<p>STM32 有一套完整的硬件抽象层（HAL）库，其目的除了抽象硬件，方便用户编写业务代码，更主要的是统一自家芯片的寄存器配置 API 、编程模型，是其初始化代码生成器 STM32CubeMX 所使用的库。</p>
<p>HAL 库中 eth 外设初始化代码如下：</p>
<pre><code class="language-c">/**
  * @brief  Initialize the Ethernet peripheral registers.
  * @param  heth: pointer to a ETH_HandleTypeDef structure that contains
  *         the configuration information for ETHERNET module
  * @retval HAL status
  */
HAL_StatusTypeDef HAL_ETH_Init(ETH_HandleTypeDef *heth)
{
  uint32_t tickstart;

  if(heth == NULL)
  {
    return HAL_ERROR;
  }

#if (USE_HAL_ETH_REGISTER_CALLBACKS == 1)

  if(heth-&gt;gState == HAL_ETH_STATE_RESET)
  {
    /* Allocate lock resource and initialize it */
    heth-&gt;Lock = HAL_UNLOCKED;

    ETH_InitCallbacksToDefault(heth);

    if(heth-&gt;MspInitCallback == NULL)
    {
      heth-&gt;MspInitCallback = HAL_ETH_MspInit;
    }

    /* Init the low level hardware */
    heth-&gt;MspInitCallback(heth);
  }

#else

  /* Check the ETH peripheral state */
  if(heth-&gt;gState == HAL_ETH_STATE_RESET)
  {
    /* Init the low level hardware : GPIO, CLOCK, NVIC. */
    HAL_ETH_MspInit(heth);
  }
#endif /* (USE_HAL_ETH_REGISTER_CALLBACKS) */

  heth-&gt;gState = HAL_ETH_STATE_BUSY;

  __HAL_RCC_SYSCFG_CLK_ENABLE();

  if(heth-&gt;Init.MediaInterface == HAL_ETH_MII_MODE)
  {
    HAL_SYSCFG_ETHInterfaceSelect(SYSCFG_ETH_MII);
  }
  else
  {
    HAL_SYSCFG_ETHInterfaceSelect(SYSCFG_ETH_RMII);
  }

  /* Ethernet Software reset */
  /* Set the SWR bit: resets all MAC subsystem internal registers and logic */
  /* After reset all the registers holds their respective reset values */
  SET_BIT(heth-&gt;Instance-&gt;DMAMR, ETH_DMAMR_SWR);

  /* Get tick */
  tickstart = HAL_GetTick();

  /* Wait for software reset */
  while (READ_BIT(heth-&gt;Instance-&gt;DMAMR, ETH_DMAMR_SWR) &gt; 0U)
  {
    if(((HAL_GetTick() - tickstart ) &gt; ETH_SWRESET_TIMEOUT))
    {
      /* Set Error Code */
      heth-&gt;ErrorCode = HAL_ETH_ERROR_TIMEOUT;
      /* Set State as Error */
      heth-&gt;gState = HAL_ETH_STATE_ERROR;
      /* Return Error */
      return HAL_ERROR;
    }
  }

  /*------------------ MDIO CSR Clock Range Configuration --------------------*/
  ETH_MAC_MDIO_ClkConfig(heth);

  /*------------------ MAC LPI 1US Tic Counter Configuration --------------------*/
  WRITE_REG(heth-&gt;Instance-&gt;MAC1USTCR, (((uint32_t)HAL_RCC_GetHCLKFreq() / ETH_MAC_US_TICK) - 1U));

  /*------------------ MAC, MTL and DMA default Configuration ----------------*/
  ETH_MACDMAConfig(heth);

  /* SET DSL to 64 bit */
  MODIFY_REG(heth-&gt;Instance-&gt;DMACCR, ETH_DMACCR_DSL, ETH_DMACCR_DSL_64BIT);

  /* Set Receive Buffers Length (must be a multiple of 4) */
  if ((heth-&gt;Init.RxBuffLen % 0x4U) != 0x0U)
  {
    /* Set Error Code */
    heth-&gt;ErrorCode = HAL_ETH_ERROR_PARAM;
    /* Set State as Error */
    heth-&gt;gState = HAL_ETH_STATE_ERROR;
    /* Return Error */
    return HAL_ERROR;
  }
  else
  {
    MODIFY_REG(heth-&gt;Instance-&gt;DMACRCR, ETH_DMACRCR_RBSZ, ((heth-&gt;Init.RxBuffLen) &lt;&lt; 1));
  }

  /*------------------ DMA Tx Descriptors Configuration ----------------------*/
  ETH_DMATxDescListInit(heth);

  /*------------------ DMA Rx Descriptors Configuration ----------------------*/
  ETH_DMARxDescListInit(heth);

  /*--------------------- ETHERNET MAC Address Configuration ------------------*/
  /* Set MAC addr bits 32 to 47 */
  heth-&gt;Instance-&gt;MACA0HR = (((uint32_t)(heth-&gt;Init.MACAddr[5]) &lt;&lt; 8) | (uint32_t)heth-&gt;Init.MACAddr[4]);
  /* Set MAC addr bits 0 to 31 */
  heth-&gt;Instance-&gt;MACA0LR = (((uint32_t)(heth-&gt;Init.MACAddr[3]) &lt;&lt; 24) | ((uint32_t)(heth-&gt;Init.MACAddr[2]) &lt;&lt; 16) |
                             ((uint32_t)(heth-&gt;Init.MACAddr[1]) &lt;&lt; 8) | (uint32_t)heth-&gt;Init.MACAddr[0]);

  heth-&gt;ErrorCode = HAL_ETH_ERROR_NONE;
  heth-&gt;gState = HAL_ETH_STATE_READY;
  heth-&gt;RxState = HAL_ETH_STATE_READY;

  return HAL_OK;
}
</code></pre>
<p>初始化流程：</p>
<ol>
<li>板级初始化：硬件、时钟等配置</li>
<li>与 PHY 芯片的连接方式配置（MII/RMII），寄存器 <code>SYSCFG::PMCR::EPIS</code></li>
<li>软复位 eth 外设，并等待复位完成，寄存器 <code>ETH::DMAMR::SWR</code></li>
<li>配置 MDIO 时钟范围，寄存器 <code>ETH::MACMDIOAR::CR</code></li>
<li>配置 1 us 计数值 ，寄存器 <code>ETH::MAC1USTCR</code></li>
<li>配置 MAC、MTL、DMA 寄存器的默认值，其中
<ol>
<li>MAC、MTL 默认配置，寄存器：<code>ETH::MACCR</code>, <code>ETH::MACECR</code>, <code>ETH::MACWTR</code>, <code>ETH::MACTFCR</code>, <code>ETH::MACRFCR</code>, <code>ETH::MTLTQOMR</code>, <code>ETH::MTLRQOMR</code></li>
<li>DMA 默认配置，寄存器 <code>ETH::DMAMR</code>, <code>ETH::DMASBMR</code>, <code>ETH::DMACCR</code>, <code>ETH::DMACTCR</code>, <code>ETH::DMACRCR</code></li>
</ol>
</li>
<li>配置描述符跳过长度，寄存器 <code>ETH::DMACCR::DSL</code></li>
<li>配置接收缓冲区长度，寄存器 <code>ETH::DMACRCR</code></li>
<li>配置 Tx 描述符</li>
<li>配置 Rx 描述符</li>
<li>配置 MAC 地址，寄存器 <code>ETH::MACA0HR</code>, <code>ETH::MACA0LR</code></li>
</ol>
<p>其中： <br>
第 2 步，具体是配置的 SYSCFG::PMCR::EPIS，系统配置控制器（SYSCFG）不做详细介绍，这里用到了外设模式配置寄存器（PMCR）的以太网 PHY 接口选择（EPIS）位域，该位域共 3 bit，b000 为 MII，b100 为 RMII，其余保留。</p>
<h2 id="rtt-中-eth-初始化"><a class="header" href="#rtt-中-eth-初始化">RTT 中 eth 初始化</a></h2>
<p>RTT 有一套自己的设备驱动框架，与 Linux 相似，其中 eth 的初始化函数如下：</p>
<pre><code class="language-c">extern void phy_reset(void);
/* EMAC initialization function */
static rt_err_t rt_stm32_eth_init(rt_device_t dev) {
    ETH_MACConfigTypeDef MACConf;
    uint32_t regvalue = 0;
    uint8_t status = RT_EOK;

    __HAL_RCC_D2SRAM3_CLK_ENABLE();

    phy_reset();

    /* ETHERNET Configuration */
    EthHandle.Instance = ETH;
    EthHandle.Init.MACAddr = (rt_uint8_t *)&amp;stm32_eth_device.dev_addr[0];
    EthHandle.Init.MediaInterface = HAL_ETH_RMII_MODE;
    EthHandle.Init.TxDesc = DMATxDscrTab;
    EthHandle.Init.RxDesc = DMARxDscrTab;
    EthHandle.Init.RxBuffLen = ETH_MAX_PACKET_SIZE;

    // SCB_InvalidateDCache();

    HAL_ETH_DeInit(&amp;EthHandle);

    /* configure ethernet peripheral (GPIOs, clocks, MAC, DMA) */
    if (HAL_ETH_Init(&amp;EthHandle) != HAL_OK) {
        LOG_E(&quot;eth hardware init failed&quot;);
    } else {
        LOG_D(&quot;eth hardware init success&quot;);
    }

    rt_memset(&amp;TxConfig, 0, sizeof(ETH_TxPacketConfig));
    TxConfig.Attributes = ETH_TX_PACKETS_FEATURES_CSUM | ETH_TX_PACKETS_FEATURES_CRCPAD;
    TxConfig.ChecksumCtrl = ETH_CHECKSUM_IPHDR_PAYLOAD_INSERT_PHDR_CALC;
    TxConfig.CRCPadCtrl = ETH_CRC_PAD_INSERT;

    for (int idx = 0; idx &lt; ETH_RX_DESC_CNT; idx++) {
        HAL_ETH_DescAssignMemory(&amp;EthHandle, idx, &amp;Rx_Buff[idx][0], NULL);
    }

    HAL_ETH_SetMDIOClockRange(&amp;EthHandle);

    for (int i = 0; i &lt;= PHY_ADDR; i++) {
        if (HAL_ETH_ReadPHYRegister(&amp;EthHandle, i, PHY_SPECIAL_MODES_REG, &amp;regvalue) != HAL_OK) {
            status = RT_ERROR;
            /* Can't read from this device address continue with next address */
            continue;
        }

        if ((regvalue &amp; PHY_BASIC_STATUS_REG) == i) {
            PHY_ADDR = i;
            status = RT_EOK;
            LOG_D(&quot;Found a phy, address:0x%02X&quot;, PHY_ADDR);
            break;
        }
    }

    if (HAL_ETH_WritePHYRegister(&amp;EthHandle, PHY_ADDR, PHY_BASIC_CONTROL_REG, PHY_RESET_MASK) ==
        HAL_OK) {
        HAL_ETH_ReadPHYRegister(&amp;EthHandle, PHY_ADDR, PHY_SPECIAL_MODES_REG, &amp;regvalue);

        uint32_t tickstart = rt_tick_get();

        /* wait until software reset is done or timeout occured  */
        while (regvalue &amp; PHY_RESET_MASK) {
            if ((rt_tick_get() - tickstart) &lt;= 500) {
                if (HAL_ETH_ReadPHYRegister(&amp;EthHandle, PHY_ADDR, PHY_BASIC_CONTROL_REG,
                                            &amp;regvalue) != HAL_OK) {
                    status = RT_ERROR;
                    break;
                }
            } else {
                status = RT_ETIMEOUT;
            }
        }
    }

    rt_thread_delay(2000);

    if (HAL_ETH_ReadPHYRegister(&amp;EthHandle, PHY_ADDR, PHY_BASIC_CONTROL_REG, &amp;regvalue) == HAL_OK) {
        regvalue |= PHY_AUTO_NEGOTIATION_MASK;
        HAL_ETH_WritePHYRegister(&amp;EthHandle, PHY_ADDR, PHY_BASIC_CONTROL_REG, regvalue);

        eth_device_linkchange(&amp;stm32_eth_device.parent, RT_TRUE);
        HAL_ETH_GetMACConfig(&amp;EthHandle, &amp;MACConf);
        MACConf.DuplexMode = ETH_FULLDUPLEX_MODE;
        MACConf.Speed = ETH_SPEED_100M;
        HAL_ETH_SetMACConfig(&amp;EthHandle, &amp;MACConf);

        HAL_ETH_Start_IT(&amp;EthHandle);
    } else {
        status = RT_ERROR;
    }

    return status;
}
</code></pre>
<p>初始化流程：</p>
<ol>
<li>PHY 芯片的硬件复位</li>
<li>定义以太网用到的资源，即 <code>ETH_InitTypeDef</code> 结构体赋值</li>
<li>初始化 eth 外设，即<a href="rust_stm32h743_eth_c.html#stm32-hal-%E4%B8%AD-eth-%E5%88%9D%E5%A7%8B%E5%8C%96">上一节</a>介绍的 <code>HAL_ETH_Init()</code> 函数</li>
<li>配置发送包的部分值，这里的值在后续使用中不再变动，后续使用是只需要修改 <code>Length</code> 和 <code>TxBuffer</code> 两个当前发送内容相关的变量</li>
<li>轮询 0～0x1F 地址，读一个特殊寄存器，如果能读到数据，则保存当前地址，并退出轮询（TODO: 根据 PHY 型号，查看该寄存器含义）</li>
<li>软复位 PHY 芯片，通过写通用控制寄存器中的复位位，并等待复位完成</li>
<li>开启自动协商，写通用控制寄存器中的自动协商位，等待协商完成后将协商结果，即速率和双工模式写回 eth 外设。这里的代码略有不同，因为使用的 PHY 比较特殊，自带双网口交换机，与单片机连接的端口是中是100M全双工。</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="llvm-修复记录"><a class="header" href="#llvm-修复记录">LLVM 修复记录</a></h1>
<p>处理 rust-for-linux-6.1 <a href="https://github.com/os2edu/rust-for-linux-6.1/issues/2">issues 2</a>，即解决在原工程加入 <code>LLVM=1</code> 编译选项后出现的编译时错误、警告。</p>
<p>以下是过程中出现的错误、警告，及其对应的修改方案：</p>
<h2 id="kconfig-中的重定义警告"><a class="header" href="#kconfig-中的重定义警告">Kconfig 中的重定义警告</a></h2>
<p><strong>编译提示:</strong></p>
<p><code>drivers/pinctrl/bst/Kconfig:3:warning: ignoring type redefinition of 'PINCTRL_MSM' from 'tristate' to 'bool'</code></p>
<p><strong>出现原因：</strong></p>
<p>重复以不同类型定义了 <code>PINCTRL_MSM</code>， 在 <code>drivers/pinctrl/bst/Kconfig:3</code> 中定义了 <code>bool</code> 类型 ，而在 <code>drivers/pinctrl/qcom/Kconfig:4</code> 中定义了 <code>tristate</code> 类型。</p>
<p><strong>解决方案：</strong></p>
<p>修改 <code>drivers/pinctrl/bst/Kconfig:3</code> 中的定义为 <code>tristate</code>，并添加默认值为 <code>default y</code></p>
<p><strong>git commit</strong></p>
<h2 id="非易失性non-volatile空指针的赋值错误"><a class="header" href="#非易失性non-volatile空指针的赋值错误">非易失性（non-volatile）空指针的赋值错误</a></h2>
<p><strong>编译提示:</strong></p>
<p><code>../drivers/gpu/arm/mali/linux/mali_osk_misc.c:54:2: error: indirection of non-volatile null pointer will be deleted, not trap [-Werror,-Wnull-dereference]</code></p>
<p><strong>出现原因：</strong></p>
<p>本义是人为制造一个运行时错误，将 0 地址强转为整形指针并赋值：<code>*(int *)0 = 0;</code>，llvm 有更严格的编译检查，认为对空地址的赋值需要是 <code>volatile</code> 的。</p>
<p><strong>解决方案：</strong></p>
<p><code>*(volatile int *)0 = (volatile int)0;</code></p>
<p><strong>git commit</strong></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="寄存器对比"><a class="header" href="#寄存器对比">寄存器对比</a></h1>
<p>BST A1000 GMAC Register Description</p>
<p><a href="./resource/rm0433-stm32h742-stm32h743753-and-stm32h750.pdf">STM32H743 RM0433.pdf</a></p>
<h2 id="gmac-registers"><a class="header" href="#gmac-registers">GMAC Registers</a></h2>
<h3 id="reg-0-0x0000"><a class="header" href="#reg-0-0x0000">Reg 0 0x0000</a></h3>
<p><em>0x0800E003</em></p>
<p><strong>STM32:</strong> <br>
工作模式配置寄存器 ETH_MACCR</p>
<ul>
<li>
<p>bit27 - 校验和减荷，会使能 IPv4 报头校验和检查以及 IPv4 或 IPv6 TCP、UDP 或 ICMP 有效负载 
校验和检查</p>
</li>
<li>
<p>bit15 - 保留，必须为复位值(0)</p>
</li>
<li>
<p>bit14 - MAC速度，0：10Mbps，1：100Mbps</p>
</li>
<li>
<p>bit13 - 双工模式，1：全双工</p>
</li>
<li>
<p>bit1 - 发送使能</p>
</li>
<li>
<p>bit0 - 接收使能</p>
</li>
</ul>
<p><strong>A1000:</strong> <br>
EQOS_MAC_R_MAC_CONFIGURATION</p>
<ul>
<li>bit15 - Port Select, 与 bit14 联合指示确切速度。在 10/100 Mbps-only （固定1），或 1000Mbps-only（固定0）模式下为只读，在 10/100/1000Mbps 配置下，为读写，0：1000～2500Mbps 选项，1：10～100Mbps 选项</li>
<li>bit14 - Speed，bit15 为 1 时，0：10Mbps，1：100Mbps，bit15 为 0 时，0：1Gbps，1：2.5Gbps</li>
</ul>
<h3 id="reg1-0x0004"><a class="header" href="#reg1-0x0004">Reg1 0x0004</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg2-0x0008"><a class="header" href="#reg2-0x0008">Reg2 0x0008</a></h3>
<p><em>0x00010404</em></p>
<p><strong>STM32:</strong> <br>
数据包过滤控制寄存器 ETH_MACPFR</p>
<ul>
<li>bit16 - VLAN 标记过滤器时能，MAC 将对其与 VLAN 标记不匹配的带 VLAN 标记的数据包</li>
<li>bit10 - Hash 或 Perfect 过滤器，如果数据包与完美过滤或散列过滤（通过 HMC 或 HUC 位设置）匹配，则地址 
过滤器会通过此数据包</li>
<li>bit2 - Hash 多播，MAC 根据 Hash 表对接收到的多播数据包执行目标地址过滤</li>
</ul>
<p><strong>A1000:</strong> <br>
<em>同上</em></p>
<h3 id="reg3-0x000c"><a class="header" href="#reg3-0x000c">Reg3 0x000C</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg4-0x0010"><a class="header" href="#reg4-0x0010">Reg4 0x0010</a></h3>
<p><em>0x00000002</em></p>
<p><strong>STM32:</strong> <br>
散列表 0 寄存器 ETH_MACHT0R</p>
<ul>
<li>64位散列表的低32位 即 [31:0]</li>
</ul>
<p><strong>A1000:</strong> <br>
<em>同上</em></p>
<h3 id="reg5-0x0014"><a class="header" href="#reg5-0x0014">Reg5 0x0014</a></h3>
<p><em>0x04000001</em></p>
<p><strong>STM32:</strong> <br>
散列表 1 寄存器 ETH_MACHT1R</p>
<ul>
<li>64位散列表的高32位 即 [63:32]</li>
</ul>
<p><strong>A1000:</strong> <br>
<em>同上</em></p>
<h3 id="reg6-0x0018"><a class="header" href="#reg6-0x0018">Reg6 0x0018</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg7-0x001c"><a class="header" href="#reg7-0x001c">Reg7 0x001C</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg8-0x0020"><a class="header" href="#reg8-0x0020">Reg8 0x0020</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg9-0x0024"><a class="header" href="#reg9-0x0024">Reg9 0x0024</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg10-0x0028"><a class="header" href="#reg10-0x0028">Reg10 0x0028</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg11-0x002c"><a class="header" href="#reg11-0x002c">Reg11 0x002C</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg12-0x0030"><a class="header" href="#reg12-0x0030">Reg12 0x0030</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg13-0x0034"><a class="header" href="#reg13-0x0034">Reg13 0x0034</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg14-0x0038"><a class="header" href="#reg14-0x0038">Reg14 0x0038</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg15-0x003c"><a class="header" href="#reg15-0x003c">Reg15 0x003C</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg16-0x0040"><a class="header" href="#reg16-0x0040">Reg16 0x0040</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg17-0x0044"><a class="header" href="#reg17-0x0044">Reg17 0x0044</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg18-0x0048"><a class="header" href="#reg18-0x0048">Reg18 0x0048</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg19-0x004c"><a class="header" href="#reg19-0x004c">Reg19 0x004C</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg20-0x0050"><a class="header" href="#reg20-0x0050">Reg20 0x0050</a></h3>
<p><em>0x0201001C</em></p>
<p><strong>STM32:</strong> <br>
VLAN 标记寄存器 ETH_MACVTR</p>
<ul>
<li>bit25 - 散列表匹配使能</li>
<li>bit16 - 12 位 VLAN 标记比较使能</li>
<li>bit[15:0] - 用于接收数据包的 VLAN 标记标识符</li>
</ul>
<p><strong>A1000:</strong> <br></p>
<ul>
<li>bit25 - 散列表匹配使能</li>
<li>bit16 - 12 位 VLAN 标记比较使能</li>
<li>bit[4:2] - 偏移，应用程序尝试访问的 MAC VLAN 标记过滤器寄存器的地址偏移量</li>
</ul>
<h3 id="reg21-0x0054"><a class="header" href="#reg21-0x0054">Reg21 0x0054</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg22-0x0058"><a class="header" href="#reg22-0x0058">Reg22 0x0058</a></h3>
<p><em>0x00000001</em></p>
<p><strong>STM32:</strong> <br>
VLAN 散列表寄存器 ETH_MACVHTR</p>
<ul>
<li>bit[15:0] - 16位 VLAN 散列表</li>
</ul>
<p><strong>A1000:</strong> <br>
<em>同上</em></p>
<h3 id="reg23-0x005c"><a class="header" href="#reg23-0x005c">Reg23 0x005C</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg24-0x0060"><a class="header" href="#reg24-0x0060">Reg24 0x0060</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg25-0x0064"><a class="header" href="#reg25-0x0064">Reg25 0x0064</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg26-0x0068"><a class="header" href="#reg26-0x0068">Reg26 0x0068</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg27-0x006c"><a class="header" href="#reg27-0x006c">Reg27 0x006C</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg28-0x0070"><a class="header" href="#reg28-0x0070">Reg28 0x0070</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg29-0x0074"><a class="header" href="#reg29-0x0074">Reg29 0x0074</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg30-0x0078"><a class="header" href="#reg30-0x0078">Reg30 0x0078</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg31-0x007c"><a class="header" href="#reg31-0x007c">Reg31 0x007C</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg32-0x0080"><a class="header" href="#reg32-0x0080">Reg32 0x0080</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg33-0x0084"><a class="header" href="#reg33-0x0084">Reg33 0x0084</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg34-0x0088"><a class="header" href="#reg34-0x0088">Reg34 0x0088</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg35-0x008c"><a class="header" href="#reg35-0x008c">Reg35 0x008C</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg36-0x0090"><a class="header" href="#reg36-0x0090">Reg36 0x0090</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg37-0x0094"><a class="header" href="#reg37-0x0094">Reg37 0x0094</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg38-0x0098"><a class="header" href="#reg38-0x0098">Reg38 0x0098</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg39-0x009c"><a class="header" href="#reg39-0x009c">Reg39 0x009C</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg40-0x00a0"><a class="header" href="#reg40-0x00a0">Reg40 0x00A0</a></h3>
<p><em>0x000000AA</em></p>
<p><strong>STM32:</strong> <br>
<em>保留</em></p>
<p><strong>A1000:</strong> <br>
EQOS_MAC_R_MAC_RXQ_CTRL0</p>
<ul>
<li>bit[7:6] - 接收队列3使能，2：使能 DCB/Generic 队列</li>
<li>bit[5:4] - 接收队列2使能，2：使能 DCB/Generic 队列</li>
<li>bit[3:2] - 接收队列1使能，2：使能 DCB/Generic 队列</li>
<li>bit[1:0] - 接收队列0使能，2：使能 DCB/Generic 队列</li>
</ul>
<h3 id="reg41-0x00a4"><a class="header" href="#reg41-0x00a4">Reg41 0x00A4</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg42-0x00a8"><a class="header" href="#reg42-0x00a8">Reg42 0x00A8</a></h3>
<p><em>0x03020100</em></p>
<p><strong>STM32:</strong> <br>
<em>保留</em></p>
<p><strong>A1000:</strong> <br>
EQOS_MAC_R_MAC_RXQ_CTRL2</p>
<ul>
<li>bit[31:24] - 接收队列3的优先级，3</li>
<li>bit[23:16] - 接收队列2的优先级，2</li>
<li>bit[15:0] - 接收队列1的优先级，1</li>
<li>bit[7:0] - 接收队列0的优先级，0</li>
</ul>
<h3 id="reg43-0x00ac"><a class="header" href="#reg43-0x00ac">Reg43 0x00AC</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg44-0x00b0"><a class="header" href="#reg44-0x00b0">Reg44 0x00B0</a></h3>
<p><em>0x00040000</em></p>
<p><strong>STM32:</strong> <br>
中断状态寄存器 ETH_MACISR</p>
<ul>
<li>bit[31:16] - 保留</li>
</ul>
<p><strong>A1000:</strong> <br>
EQOS_MAC_R_MAC_INTERRUPT_STATUS</p>
<ul>
<li>bit18 - MDIO Interrupt Status，MDIO 完成操作中断指示位</li>
</ul>
<h3 id="reg45-0x00b4"><a class="header" href="#reg45-0x00b4">Reg45 0x00B4</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg46-0x00b8"><a class="header" href="#reg46-0x00b8">Reg46 0x00B8</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg47-0x00bc"><a class="header" href="#reg47-0x00bc">Reg47 0x00BC</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg48-0x00c0"><a class="header" href="#reg48-0x00c0">Reg48 0x00C0</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg49-0x00c4"><a class="header" href="#reg49-0x00c4">Reg49 0x00C4</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg50-0x00c8"><a class="header" href="#reg50-0x00c8">Reg50 0x00C8</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg51-0x00cc"><a class="header" href="#reg51-0x00cc">Reg51 0x00CC</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg52-0x00d0"><a class="header" href="#reg52-0x00d0">Reg52 0x00D0</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg53-0x00d4"><a class="header" href="#reg53-0x00d4">Reg53 0x00D4</a></h3>
<p><em>0x03E80000</em></p>
<p><strong>STM32:</strong> <br>
LPI 定时器控制寄存器 ETH_MACLTCR</p>
<ul>
<li>bit[25:16] - LPI LS 定时器，在可以将 LPI 模式发送到 PHY 之前，来自 PHY 的链路状态 (OKAY) 应持续的最短 
时间（以毫秒为单位），1000</li>
</ul>
<p><strong>A1000:</strong> <br>
<em>同上</em></p>
<h3 id="reg54-0x00d8"><a class="header" href="#reg54-0x00d8">Reg54 0x00D8</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h2 id="dma-registers"><a class="header" href="#dma-registers">DMA Registers</a></h2>
<blockquote>
<p>未完成，寄存器对应关系不对</p>
<p>直接查看 <a href="./rust_register_info.html">寄存器说明</a></p>
</blockquote>
<h3 id="reg0-0x1000"><a class="header" href="#reg0-0x1000">Reg0 0x1000</a></h3>
<p><em>0x00010000</em></p>
<p><strong>STM32:</strong> <br>
DMA 模式寄存器 ETH_DMAMR</p>
<ul>
<li>bit[17:16] - 以太网外设的中断模式，<br>0：检测到传送完成事件时，TI/RI 状态信号会被置 1。软件驱动程序向这些位写入 1 时，这些位会被清零。如果还在 ETH_DMACIER 寄存器中使能了相应的中断，则中断信号会被置为有效；<br>1：如上所述，TI/RI 置 1。不过，对于任一 RI/TI 事件，都不会触发中断；<br>2：RI/TI 状态位会在检测到传送完成事件时置 1，并且会在软件驱动程序通过写入 1 来将其清零时复位。不过，如果在软件将其清除（处理）之前检测到另一个传送完成事件，则会自动再次将这些状态位置 1。但是，并非基于 TI/RI 生成中断。</li>
</ul>
<p><strong>A1000:</strong> <br>
<em>同上</em></p>
<h3 id="reg1-0x1004"><a class="header" href="#reg1-0x1004">Reg1 0x1004</a></h3>
<p><em>0x00080011</em></p>
<p><strong>STM32:</strong> <br>
系统总线模式寄存器 ETH_DMASBMR</p>
<ul>
<li>bit19 - 保留</li>
<li>bit1 - 保留</li>
<li>bit0 - 固定突发长度，1：AHB 主设备将发起特定长度的突发传输（INCRx 或 SINGLE）</li>
</ul>
<p><strong>A1000:</strong> <br></p>
<ul>
<li>bit[19:16] - AXI 最大读取未完成请求限制，8</li>
<li>bit1 - AXI 突发长度为4</li>
<li>bit0 - 固定突发长度</li>
</ul>
<h3 id="reg2-0x1008"><a class="header" href="#reg2-0x1008">Reg2 0x1008</a></h3>
<p><em>0x00080C01</em></p>
<p><strong>STM32:</strong> <br>
中断状态寄存器 ETH_DMAISR</p>
<ul>
<li>bit19 - 保留</li>
<li>bit11 - 保留</li>
<li>bit10 - 保留</li>
<li>bit0 - DMA 通道中断状态，此位指示 DMA 通道中发生的中断事件。要将该位复位为 0，软件必须读取 DMA 通道中的相应寄存器，以获取产生中断的具体原因，然后将中断源清除。</li>
</ul>
<p><strong>A1000:</strong> <br></p>
<ul>
<li>bit0 - DMA Ch0 中断状态，清除条件同上。</li>
</ul>
<h3 id="reg3-0x100c"><a class="header" href="#reg3-0x100c">Reg3 0x100C</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br>
ETH_DMADSR</p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg4-0x1100"><a class="header" href="#reg4-0x1100">Reg4 0x1100</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br>
ETH_DMACCR</p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg5-0x1104"><a class="header" href="#reg5-0x1104">Reg5 0x1104</a></h3>
<p><em>0x83194000</em></p>
<p><strong>STM32:</strong> <br>
ETH_DMACTxCR</p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg6-0x1108"><a class="header" href="#reg6-0x1108">Reg6 0x1108</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br>
ETH_DMACRxCR</p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg7-0x110c"><a class="header" href="#reg7-0x110c">Reg7 0x110C</a></h3>
<p><em>0x83186000</em></p>
<p><strong>STM32:</strong> <br>
<em>保留</em></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg8-0x1100"><a class="header" href="#reg8-0x1100">Reg8 0x1100</a></h3>
<p><em>0x83194000</em></p>
<p><strong>STM32:</strong> <br>
<em>保留</em></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg9-0x1114"><a class="header" href="#reg9-0x1114">Reg9 0x1114</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg10-0x1028"><a class="header" href="#reg10-0x1028">Reg10 0x1028</a></h3>
<p><em>0x83188000</em></p>
<p><strong>STM32:</strong> <br>
ETH_DMACTxDLAR</p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg11-0x111c"><a class="header" href="#reg11-0x111c">Reg11 0x111C</a></h3>
<p><em>0x000001FF</em></p>
<p><strong>STM32:</strong> <br>
ETH_DMACRxDLAR</p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg12-0x1120"><a class="header" href="#reg12-0x1120">Reg12 0x1120</a></h3>
<p><em>0x000001FF</em></p>
<p><strong>STM32:</strong> <br>
ETH_DMACTxDTPR</p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg13-0x1124"><a class="header" href="#reg13-0x1124">Reg13 0x1124</a></h3>
<p><em>0x0000D041</em></p>
<p><strong>STM32:</strong> <br>
<em>保留</em></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg14-0x1128"><a class="header" href="#reg14-0x1128">Reg14 0x1128</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br>
ETH_DMACRxDTPR</p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg15-0x112c"><a class="header" href="#reg15-0x112c">Reg15 0x112C</a></h3>
<p><em>0x000007C0</em></p>
<p><strong>STM32:</strong> <br>
ETH_DMACTxDRLR</p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg16-0x1130"><a class="header" href="#reg16-0x1130">Reg16 0x1130</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br>
ETH_DMACRxDRLR</p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg17-0x1134"><a class="header" href="#reg17-0x1134">Reg17 0x1134</a></h3>
<p><em>0x83194000</em></p>
<p><strong>STM32:</strong> <br>
ETH_DMACIER</p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg18-0x1138"><a class="header" href="#reg18-0x1138">Reg18 0x1138</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br>
ETH_DMACRxIWTR</p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg19-0x1140"><a class="header" href="#reg19-0x1140">Reg19 0x1140</a></h3>
<p><em>0x83186260</em></p>
<p><strong>STM32:</strong> <br>
<em>保留</em></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg20-0x1050"><a class="header" href="#reg20-0x1050">Reg20 0x1050</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br></p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg21-0x1054"><a class="header" href="#reg21-0x1054">Reg21 0x1054</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br>
ETH_DMACCATxBR</p>
<p><strong>A1000:</strong> <br></p>
<h3 id="reg22-0x116c"><a class="header" href="#reg22-0x116c">Reg22 0x116C</a></h3>
<p><em>0x00000000</em></p>
<p><strong>STM32:</strong> <br>
ETH_DMACMFCR</p>
<p><strong>A1000:</strong> <br></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="寄存器说明"><a class="header" href="#寄存器说明">寄存器说明</a></h1>
<h2 id="mac"><a class="header" href="#mac">MAC</a></h2>
<pre><code>// 非零寄存器
Reg0 : 0800a003
Reg40: 000000aa
Reg42: 03020100
Reg44: 00040008
Reg53: 03e80000
</code></pre>
<ul>
<li>Reg 0 <br>
0b0000_1000_0000_0000_xx10_0000_0000_0011<br>
使能校验、发送、接收，<br>
其中<code>xx</code>为速度，包括后面的1是全双工模式，都是需要和 PHY 联合设置的。</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>bit 15</th><th>bit 14</th><th>速度</th></tr></thead><tbody>
<tr><td>1</td><td>0</td><td>10Mbps</td></tr>
<tr><td>1</td><td>1</td><td>100Mbps</td></tr>
<tr><td>0</td><td>0</td><td>1Gbps</td></tr>
<tr><td>0</td><td>1</td><td>2.5Gbps</td></tr>
</tbody></table>
</div>
<ul>
<li>
<p>Reg 40 <br>
<strong>可以固定，值为 <code>0x000000AA</code></strong> <br>
使能接收队列0、1、2、3,并用于DCB/Generic</p>
</li>
<li>
<p>Reg 42 <br>
<strong>可以固定，值为 <code>0x03020100</code></strong> <br>
设置接收队列0～3的优先级分别为3～0</p>
</li>
<li>
<p>Reg 44 <br>
<strong>中断状态寄存器，不可写入固定值</strong> <br>
当前 0x00040008 表示：MDIO 中断、PHY 中断</p>
</li>
<li>
<p>Reg 45 <br>
<strong>可以固定，值为 <code>0x03e80000</code></strong> <br>
一个定时器，当前值为 1000ms</p>
</li>
</ul>
<h2 id="dma-ctrl"><a class="header" href="#dma-ctrl">DMA CTRL</a></h2>
<pre><code>// 非零寄存器
Reg0: 00010000
Reg1: 0f0f080f
Reg3: 03030300
Reg4: 00000003
</code></pre>
<ul>
<li>
<p>Reg 0 <br>
<strong>可以固定，值为 <code>0x00010000</code></strong> <br>
表示传送完成可以触发中断，与 ETH_DMACIER 联合工作。</p>
</li>
<li>
<p>Reg 1 <br>
<strong>可以固定，值为 <code>0x0f0f080f</code></strong> <br>
表示AXI 最大未完成写请求数为16、读请求数为16；使能增强地址模式；固定突发长度，长度可以是1、4、8、16</p>
</li>
<li>
<p>Reg 3 Reg 4 <br>
<strong>可以固定，值为 <code>0x00000000</code></strong> <br>
调试寄存器，可以不写，保持默认值</p>
</li>
</ul>
<h2 id="dma-ch0"><a class="header" href="#dma-ch0">DMA CH0</a></h2>
<pre><code>// 非零寄存器
Reg0 : 00010000
Reg1 : 00080011
Reg2 : 00080c01
Reg5 : 83194000
Reg7 : 83186000
Reg8 : 83194000
Reg10: 83188000
Reg11: 000001ff
Reg12: 000001ff
Reg13: 0000d041
Reg15: 000007c0
Reg17: 83194000
Reg19: 83186000
Reg22: 00000001
Reg23: 99a5d040
</code></pre>
<ul>
<li>
<p>Reg 0 <br>
<strong>可以固定，值为 <code>0x00010000</code></strong> <br>
表示使能 8xPBL 模式</p>
</li>
<li>
<p>Reg 1 <br>
<strong>可以固定，值为 <code>0x00080011</code>，写入后开启发送</strong> <br>
表示设置传输突发长度、使能提前处理第二个数据包、<strong>开启传输</strong></p>
</li>
<li>
<p>Reg 2 <br>
<strong>可以固定，值为 <code>0x00080c01</code>，写入后开启接收</strong> <br>
表示设置接收突发长度、接收缓冲区长度、<strong>开启接收</strong></p>
</li>
<li>
<p>Reg 5 <br>
<strong>不可以固定</strong> <br>
表示发送描述符列表的<strong>起始</strong>地址</p>
</li>
<li>
<p>Reg 7 <br>
<strong>不可以固定</strong> <br>
表示接收描述符列表的<strong>起始</strong>地址</p>
</li>
<li>
<p>Reg 8 <br>
<strong>不可以固定</strong> <br>
表示发送描述符列表的<strong>结束</strong>地址</p>
</li>
<li>
<p>Reg 10 <br>
<strong>不可以固定</strong> <br>
表示接收描述符列表的<strong>结束</strong>地址</p>
</li>
<li>
<p>Reg 11 <br>
<strong>可以固定，值为 <code>0x000001ff</code></strong> <br>
表示环形发送描述符长度，此处为512</p>
</li>
<li>
<p>Reg 12 <br>
<strong>可以固定，值为 <code>0x000001ff</code></strong> <br>
表示环形接收描述符长度，此处为512</p>
</li>
<li>
<p>Reg 13 <br>
<strong>可以固定，值为 <code>0x0000d041</code></strong> <br>
中断使能，表示使能发送、Tx缓冲区满、接收、提前接收中断，发送停止、Rx缓冲区满、接收停止、接收看门狗、提前发送、致命错误中断。</p>
</li>
<li>
<p>Reg 15 <br>
<strong>可以固定，值为 <code>0x000007c0</code></strong> <br>
此处值为复位默认值，可以不用写，表示的是 TxDMA 工作间隔时间 125us</p>
</li>
<li>
<p>Reg 17 <br>
<strong>只读寄存器</strong> <br>
表示当前发送描述符</p>
</li>
<li>
<p>Reg 19 <br>
<strong>只读寄存器</strong> <br>
表示当前接收描述符</p>
</li>
<li>
<p>Reg 22 <br>
<strong>只读寄存器`</strong> <br>
当前接收缓冲区地址指针的高8位</p>
</li>
<li>
<p>Reg 23 <br>
<strong>只读寄存器</strong> <br>
当前接收缓冲区地址指针的低32位</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="c-驱动分析"><a class="header" href="#c-驱动分析">C 驱动分析</a></h1>
<!-- ![dwmac-c-minimal](./resource/dwmac-c-minimal.svg)
<image src="./resource/dwmac-c-minimal.svg"></image> -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 707.3010324865888 573.9063851344281" width="707.3010324865888" height="573.9063851344281">
  <!-- svg-source:excalidraw -->
<defs>
    <style class="style-fonts">
      @font-face {
        font-family: "Virgil";
        src: url("https://excalidraw.com/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://excalidraw.com/Cascadia.woff2");
      }
    </style>
  </defs>
  <g stroke-linecap="round" transform="translate(71.37493005184578 10) rotate(0 84.80001831054688 65.59999084472659)"><path d="M7.86 8.16 C7.86 8.16, 7.86 8.16, 7.86 8.16 M7.86 8.16 C7.86 8.16, 7.86 8.16, 7.86 8.16 M3.66 19.09 C9.83 13.91, 16.26 8.11, 18.1 2.48 M3.66 19.09 C5.52 15.68, 8.68 12.71, 18.1 2.48 M2.75 26.24 C9.17 19.89, 14.63 13.39, 24.4 1.33 M2.75 26.24 C11.45 17.11, 18.38 7.29, 24.4 1.33 M2.48 32.64 C11.08 22.91, 18.42 15.3, 30.7 0.18 M2.48 32.64 C8.67 25.48, 14.6 18.13, 30.7 0.18 M2.88 38.28 C11.57 28.57, 19.16 16.75, 34.37 2.05 M2.88 38.28 C12.69 28.39, 20.65 17.15, 34.37 2.05 M2.62 44.68 C11.2 34.33, 21.55 19.36, 39.36 2.41 M2.62 44.68 C15.19 31.59, 26.9 17.7, 39.36 2.41 M2.36 51.07 C12.73 39.64, 21.55 30.27, 45 2.02 M2.36 51.07 C17.53 34.18, 34.45 14.91, 45 2.02 M2.75 56.72 C14.28 40.42, 27.85 26.45, 49.99 2.38 M2.75 56.72 C20.6 37.03, 37.81 16.04, 49.99 2.38 M2.49 63.11 C12.44 49.99, 26.56 37.45, 55.63 1.98 M2.49 63.11 C18.19 46.65, 33.06 29.75, 55.63 1.98 M2.88 68.76 C25.48 44.27, 46.08 23.26, 60.62 2.34 M2.88 68.76 C15.65 54.95, 29.42 38.69, 60.62 2.34 M2.62 75.16 C25 47.79, 47.89 21.7, 66.26 1.95 M2.62 75.16 C16.81 58.18, 32.16 41.19, 66.26 1.95 M2.36 81.55 C20.33 60.5, 39.07 39.34, 71.25 2.31 M2.36 81.55 C20.89 60.13, 38.5 39.03, 71.25 2.31 M2.76 87.2 C18.12 68.1, 34.95 52.66, 76.89 1.91 M2.76 87.2 C20.43 68.64, 36.79 48.97, 76.89 1.91 M2.49 93.59 C31.07 58.35, 64.01 23.58, 81.88 2.27 M2.49 93.59 C24.39 68.8, 46.78 43.26, 81.88 2.27 M2.89 99.24 C34.49 64.16, 59.88 32.23, 87.52 1.88 M2.89 99.24 C21.47 75.81, 41.1 53.29, 87.52 1.88 M1.32 107.14 C23.7 78.48, 50.38 53.79, 92.51 2.24 M1.32 107.14 C23.53 81.35, 44.63 57.41, 92.51 2.24 M2.37 112.03 C37.03 72.6, 66.56 36.5, 98.15 1.85 M2.37 112.03 C40.41 69.59, 76.98 26.45, 98.15 1.85 M4.07 116.17 C36.12 80.31, 66.92 41.66, 103.14 2.21 M4.07 116.17 C30.6 86.57, 57.43 55.63, 103.14 2.21 M5.78 120.3 C29.39 90.76, 57.98 59.88, 108.78 1.81 M5.78 120.3 C29.73 92.36, 52.84 63.97, 108.78 1.81 M8.14 123.68 C28.34 96.19, 50.38 71.8, 113.77 2.17 M8.14 123.68 C36.2 89.26, 65.38 56.22, 113.77 2.17 M11.82 125.55 C46.09 87.62, 76.52 51.65, 119.41 1.78 M11.82 125.55 C39.37 93.47, 67.5 63.08, 119.41 1.78 M15.49 127.42 C52.98 80.86, 94.82 34.45, 124.4 2.14 M15.49 127.42 C52.16 84.92, 91.4 42.35, 124.4 2.14 M18.51 130.04 C62.35 82.29, 104.01 34.07, 130.04 1.74 M18.51 130.04 C54.62 89.2, 89.95 48.04, 130.04 1.74 M23.5 130.4 C57.43 91.06, 87.66 54.46, 135.03 2.1 M23.5 130.4 C61.78 86.11, 101.13 42.42, 135.03 2.1 M27.83 131.52 C64.93 86.4, 104.79 39.08, 140.02 2.46 M27.83 131.52 C60.71 94.79, 92.4 59.86, 140.02 2.46 M32.82 131.88 C65.28 95.97, 95.81 56.71, 145 2.82 M32.82 131.88 C67.25 94.34, 100.51 55.77, 145 2.82 M37.8 132.24 C82.02 84.27, 123.43 36.5, 149.33 3.94 M37.8 132.24 C76.95 87, 116.13 41.47, 149.33 3.94 M43.45 131.84 C75.88 95.44, 109.8 54.97, 154.32 4.3 M43.45 131.84 C66.37 102.77, 89.41 75.31, 154.32 4.3 M48.43 132.2 C91.74 84.32, 134.38 35.33, 158 6.17 M48.43 132.2 C86.81 88.87, 124.71 45.31, 158 6.17 M54.08 131.81 C81.01 96.43, 111.24 62.98, 161.67 8.04 M54.08 131.81 C86.46 95.19, 116.39 60.5, 161.67 8.04 M59.06 132.17 C94.17 89.85, 132.6 48.47, 164.03 11.42 M59.06 132.17 C80.34 105.81, 104.3 79.05, 164.03 11.42 M64.71 131.77 C86.72 110.83, 107.09 87.97, 165.74 15.55 M64.71 131.77 C92 99.4, 119.91 69.25, 165.74 15.55 M69.69 132.13 C95.75 100.4, 123.59 72.29, 168.1 18.93 M69.69 132.13 C102.16 96.59, 133.09 60.38, 168.1 18.93 M75.34 131.74 C102.2 100.66, 130.31 68.91, 169.15 23.82 M75.34 131.74 C103.45 99.34, 132.23 67.41, 169.15 23.82 M80.32 132.1 C112.68 94.58, 142.9 58.87, 169.55 29.46 M80.32 132.1 C114.02 95.17, 147.33 57.34, 169.55 29.46 M85.97 131.71 C117.31 95.86, 150.88 58.38, 171.25 33.59 M85.97 131.71 C108.61 104.58, 131.04 78.04, 171.25 33.59 M90.95 132.07 C115.05 104.4, 134.68 79, 170.99 39.99 M90.95 132.07 C112.73 106.34, 134.31 81.19, 170.99 39.99 M96.6 131.67 C122.73 102.37, 146.66 76.78, 171.39 45.63 M96.6 131.67 C117.77 107.53, 138.95 82.11, 171.39 45.63 M101.58 132.03 C121.83 106.35, 143.94 83.59, 171.13 52.03 M101.58 132.03 C120.46 109.97, 140.14 86.41, 171.13 52.03 M107.23 131.64 C120.73 117.52, 132.57 99.25, 170.86 58.43 M107.23 131.64 C133.05 102.29, 157.9 73.45, 170.86 58.43 M112.21 132 C130.57 110.74, 149.82 90.6, 171.26 64.07 M112.21 132 C127.26 114.11, 143.39 96.37, 171.26 64.07 M117.86 131.6 C136.97 109.35, 155.21 90.08, 171 70.47 M117.86 131.6 C130.61 116.51, 142.85 102.22, 171 70.47 M122.84 131.96 C133.27 120.96, 146.87 105.46, 170.74 76.87 M122.84 131.96 C134.5 117.68, 146.27 104.85, 170.74 76.87 M128.49 131.57 C139.64 119.1, 153.04 104.43, 171.13 82.51 M128.49 131.57 C138 121.02, 145.99 110.74, 171.13 82.51 M133.47 131.93 C143.02 122.72, 150.99 113.79, 170.87 88.91 M133.47 131.93 C142.27 122.71, 148.36 114.31, 170.87 88.91 M138.46 132.29 C148.01 118.83, 161.86 107.06, 170.61 95.31 M138.46 132.29 C149.22 119.76, 159.32 107.7, 170.61 95.31 M144.76 131.14 C150.18 125.55, 155.71 118.39, 171 100.95 M144.76 131.14 C153.69 120.62, 160.39 111.84, 171 100.95 M151.72 129.23 C158.54 121.93, 166.05 113.05, 170.08 108.1 M151.72 129.23 C157 123.01, 162.37 116.08, 170.08 108.1" stroke="#ffc9c9" stroke-width="0.5" fill="none"></path><path d="M32 0 M32 0 C64.91 0.86, 95.01 -1.21, 137.6 0 M32 0 C67.06 -0.43, 100.11 0.55, 137.6 0 M137.6 0 C158.49 -0.75, 168.93 10.88, 169.6 32 M137.6 0 C157.97 -0.77, 169.61 10.65, 169.6 32 M169.6 32 C169.14 60.34, 170.48 83.07, 169.6 99.2 M169.6 32 C170.51 47.26, 170.37 61.73, 169.6 99.2 M169.6 99.2 C167.65 119.14, 160.73 129.34, 137.6 131.2 M169.6 99.2 C171.87 119.29, 161.08 130.62, 137.6 131.2 M137.6 131.2 C103.01 131.4, 63.8 132.95, 32 131.2 M137.6 131.2 C105.19 130.95, 72.97 130.86, 32 131.2 M32 131.2 C11.69 130.14, -1.34 120.16, 0 99.2 M32 131.2 C12.81 131.61, -0.82 120.35, 0 99.2 M0 99.2 C0.15 77.86, -0.19 54.1, 0 32 M0 99.2 C-0.07 73.48, -0.11 47.14, 0 32 M0 32 C-0.51 8.73, 9.19 -1.63, 32 0 M0 32 C-2.24 10.96, 9.59 -0.49, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(72.37493005184578 56) rotate(0 83.64484500784893 0.000700438911820811)"><path d="M0.08 -0.11 C28.12 -0.18, 140.44 -0.32, 168.63 -0.22 M-1.34 -1.21 C26.5 -1.11, 139.25 1.26, 167.59 1.21" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(108.65816126461638 21.66478151945921) rotate(0 49.48994445800781 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">.ko module</text></g><g transform="translate(84.77303205892972 68.73387124441024) rotate(0 66.05992889404297 25.00000000000003)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">module_init()</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">module_exit()</text></g><g stroke-linecap="round" transform="translate(271.5846398619625 10.58622611527494) rotate(0 84.80001831054688 65.59999084472659)"><path d="M7.86 8.16 C7.86 8.16, 7.86 8.16, 7.86 8.16 M7.86 8.16 C7.86 8.16, 7.86 8.16, 7.86 8.16 M3.66 19.09 C7.5 14.84, 11.73 13.07, 18.1 2.48 M3.66 19.09 C8.95 14.14, 13.14 7.54, 18.1 2.48 M2.75 26.24 C8.83 20.75, 16.05 12.55, 24.4 1.33 M2.75 26.24 C8.13 19.44, 13.34 13.64, 24.4 1.33 M2.48 32.64 C12.17 24.07, 18.79 13.68, 30.7 0.18 M2.48 32.64 C9.33 25.04, 14.76 19.39, 30.7 0.18 M2.88 38.28 C9.08 30.7, 16.82 22.24, 34.37 2.05 M2.88 38.28 C9.26 30.6, 17.54 22.72, 34.37 2.05 M2.62 44.68 C11.48 33.76, 16.06 28.77, 39.36 2.41 M2.62 44.68 C14.8 30.02, 27.58 15.53, 39.36 2.41 M2.36 51.07 C13.88 40.46, 21.72 30.45, 45 2.02 M2.36 51.07 C14.94 35.41, 28.96 20.23, 45 2.02 M2.75 56.72 C12.11 42.07, 24.43 32.51, 49.99 2.38 M2.75 56.72 C19.66 37.08, 36.62 16.49, 49.99 2.38 M2.49 63.11 C15.57 47.16, 28.33 33.17, 55.63 1.98 M2.49 63.11 C20.13 42.19, 36.35 23.8, 55.63 1.98 M2.88 68.76 C22.57 45.91, 44.21 17.79, 60.62 2.34 M2.88 68.76 C17.06 51.83, 30.85 34.79, 60.62 2.34 M2.62 75.16 C17.87 56.09, 37.65 34.62, 66.26 1.95 M2.62 75.16 C17.12 57.88, 32.9 40.04, 66.26 1.95 M2.36 81.55 C31.04 49.75, 58.58 19.73, 71.25 2.31 M2.36 81.55 C28.74 52.12, 53.43 23.81, 71.25 2.31 M2.76 87.2 C21.44 64.1, 44.08 41.93, 76.89 1.91 M2.76 87.2 C19.16 68.6, 34.43 51.36, 76.89 1.91 M2.49 93.59 C26.62 66.71, 51.57 37.06, 81.88 2.27 M2.49 93.59 C21.11 71.16, 39.48 50.56, 81.88 2.27 M2.89 99.24 C26.76 72.8, 51.91 44.71, 87.52 1.88 M2.89 99.24 C30.83 66.66, 58.1 33.71, 87.52 1.88 M1.32 107.14 C35.18 71.97, 65.84 33.36, 92.51 2.24 M1.32 107.14 C35.56 67.12, 70.08 29.67, 92.51 2.24 M2.37 112.03 C33.68 72.29, 68.31 32.94, 98.15 1.85 M2.37 112.03 C34.67 75.21, 65.93 40.29, 98.15 1.85 M4.07 116.17 C43.96 72.78, 83.04 27.27, 103.14 2.21 M4.07 116.17 C31.06 87.18, 55.94 57.41, 103.14 2.21 M5.78 120.3 C43.5 79.66, 79.52 36.79, 108.78 1.81 M5.78 120.3 C34.35 90.09, 60.39 59.85, 108.78 1.81 M8.14 123.68 C42.31 85, 75.02 45.88, 113.77 2.17 M8.14 123.68 C45.33 79.26, 85.31 34.57, 113.77 2.17 M11.82 125.55 C53.02 77.39, 93.91 29.78, 119.41 1.78 M11.82 125.55 C50.87 79.72, 89.46 33.9, 119.41 1.78 M15.49 127.42 C38.49 101.12, 61.94 72.37, 124.4 2.14 M15.49 127.42 C50.47 87.14, 83.72 49.14, 124.4 2.14 M18.51 130.04 C60.33 84.51, 104.16 33.47, 130.04 1.74 M18.51 130.04 C50.97 94.72, 81.49 59.37, 130.04 1.74 M23.5 130.4 C49.73 99.33, 75.41 68.11, 135.03 2.1 M23.5 130.4 C60.71 89.06, 94.87 48.49, 135.03 2.1 M27.83 131.52 C56.3 98.98, 84.14 67.95, 140.02 2.46 M27.83 131.52 C70.62 81.14, 115.64 28.72, 140.02 2.46 M32.82 131.88 C68.68 86.18, 110.21 42.12, 145 2.82 M32.82 131.88 C71.32 85.69, 113.04 40.58, 145 2.82 M37.8 132.24 C82.58 78.61, 128.29 27.8, 149.33 3.94 M37.8 132.24 C68.93 96.71, 100.8 61.03, 149.33 3.94 M43.45 131.84 C75.99 92.03, 112.94 54.5, 154.32 4.3 M43.45 131.84 C85.25 81.27, 129.33 30.19, 154.32 4.3 M48.43 132.2 C71.78 105.36, 92.33 77.99, 158 6.17 M48.43 132.2 C78.11 97.98, 108.9 63.26, 158 6.17 M54.08 131.81 C91.8 88, 133.26 43.31, 161.67 8.04 M54.08 131.81 C92.83 87.22, 131.65 42.27, 161.67 8.04 M59.06 132.17 C90.84 93.8, 125.87 56.14, 164.03 11.42 M59.06 132.17 C92.57 93.29, 125.79 55.73, 164.03 11.42 M64.71 131.77 C94.9 94.46, 125.92 59.75, 165.74 15.55 M64.71 131.77 C101.95 89.04, 140.26 44.19, 165.74 15.55 M69.69 132.13 C105.61 92.19, 141.95 49.18, 168.1 18.93 M69.69 132.13 C98.96 98.52, 126.22 65.85, 168.1 18.93 M75.34 131.74 C96.3 106.96, 116.47 83.57, 169.15 23.82 M75.34 131.74 C102.89 100.29, 131.7 66.89, 169.15 23.82 M80.32 132.1 C99.32 112.04, 119.43 90.59, 169.55 29.46 M80.32 132.1 C104.6 103.88, 130.04 76.13, 169.55 29.46 M85.97 131.71 C101.03 111.79, 120.14 93.64, 171.25 33.59 M85.97 131.71 C105.41 110.49, 123.27 87.32, 171.25 33.59 M90.95 132.07 C119.26 98.3, 149.78 62.23, 170.99 39.99 M90.95 132.07 C114.56 105.13, 139.57 76.45, 170.99 39.99 M96.6 131.67 C123.14 103.01, 148.01 74.01, 171.39 45.63 M96.6 131.67 C124.31 101.72, 150.83 69.78, 171.39 45.63 M101.58 132.03 C125.78 103.58, 148.84 75.65, 171.13 52.03 M101.58 132.03 C117.12 114.4, 131.56 98.63, 171.13 52.03 M107.23 131.64 C129.71 104.2, 155.39 75.32, 170.86 58.43 M107.23 131.64 C127.49 107.69, 147.58 85.42, 170.86 58.43 M112.21 132 C128.38 111.96, 146.77 88.12, 171.26 64.07 M112.21 132 C135.76 105.01, 158.06 79.22, 171.26 64.07 M117.86 131.6 C132.1 114.33, 149.46 96.46, 171 70.47 M117.86 131.6 C132.65 114.08, 147.89 96.87, 171 70.47 M122.84 131.96 C134.55 120.19, 144.56 106.99, 170.74 76.87 M122.84 131.96 C134.22 120.75, 144.51 108.24, 170.74 76.87 M128.49 131.57 C138.14 119.77, 148.45 111.63, 171.13 82.51 M128.49 131.57 C137.18 120.55, 147.72 109.58, 171.13 82.51 M133.47 131.93 C143.78 121.2, 153.36 108.1, 170.87 88.91 M133.47 131.93 C142.57 121.72, 150.16 111.74, 170.87 88.91 M138.46 132.29 C145 123.14, 150.7 114.39, 170.61 95.31 M138.46 132.29 C146.66 122.59, 154.81 112.07, 170.61 95.31 M144.76 131.14 C152.72 124.05, 158.34 113.46, 171 100.95 M144.76 131.14 C154.79 120.37, 163.31 109.15, 171 100.95 M151.72 129.23 C158.1 123.18, 161.99 115.43, 170.08 108.1 M151.72 129.23 C158.18 122.8, 162.86 115.29, 170.08 108.1" stroke="#ffc9c9" stroke-width="0.5" fill="none"></path><path d="M32 0 M32 0 C64.27 -0.58, 99.68 -1.14, 137.6 0 M32 0 C63.51 1.29, 93.52 0.56, 137.6 0 M137.6 0 C159.49 0.65, 167.68 10.66, 169.6 32 M137.6 0 C157.93 -2.2, 171.37 10.01, 169.6 32 M169.6 32 C167.26 45, 169.17 59.05, 169.6 99.2 M169.6 32 C169.17 52.7, 169.28 73.41, 169.6 99.2 M169.6 99.2 C171.2 120.79, 160.35 129.74, 137.6 131.2 M169.6 99.2 C168.17 119.42, 160.99 132.81, 137.6 131.2 M137.6 131.2 C114.35 133.11, 89.02 130.44, 32 131.2 M137.6 131.2 C103.16 131.49, 69.05 131.36, 32 131.2 M32 131.2 C8.73 132.66, -0.03 121.91, 0 99.2 M32 131.2 C8.55 129.68, -2.11 121.92, 0 99.2 M0 99.2 C-0.52 85.76, 0.33 66.66, 0 32 M0 99.2 C1.27 83.88, -0.64 68.68, 0 32 M0 32 C1.58 10.12, 9.62 -0.4, 32 0 M0 32 C1.34 9.57, 8.47 -1.42, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(272.5846398619625 56.586226115274826) rotate(0 84.42684220079795 -0.2898004710674229)"><path d="M1.16 0.56 C29.1 0.33, 140.75 -0.96, 168.54 -1.14 M0.31 -0.19 C27.99 -0.34, 139.11 -0.32, 167.46 -0.2" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(294.4757766838237 22.208285503513423) rotate(0 62.09992218017578 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">platform bus</text></g><g transform="translate(271.851133523198 68.50322551538335) rotate(0 83.60990905761719 25)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">driver_register</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">driver_unregister</text></g><g stroke-linecap="round" transform="translate(470.4867800568485 10.75155824520101) rotate(0 84.80001831054688 65.59999084472656)"><path d="M7.86 8.16 C7.86 8.16, 7.86 8.16, 7.86 8.16 M7.86 8.16 C7.86 8.16, 7.86 8.16, 7.86 8.16 M3.66 19.09 C6.67 14.11, 11.12 8.44, 18.1 2.48 M3.66 19.09 C8.35 12.54, 14.07 7.91, 18.1 2.48 M2.75 26.24 C10.62 15.59, 19.18 7.54, 24.4 1.33 M2.75 26.24 C6.5 19.77, 11.01 14.53, 24.4 1.33 M2.48 32.64 C11.57 23.17, 18.71 13.83, 30.7 0.18 M2.48 32.64 C9.43 24.85, 16.14 16.75, 30.7 0.18 M2.88 38.28 C15.27 26.74, 28.11 11.01, 34.37 2.05 M2.88 38.28 C10.42 29.51, 18.36 21.54, 34.37 2.05 M2.62 44.68 C9.99 35.31, 20.78 24.22, 39.36 2.41 M2.62 44.68 C16.34 28.38, 31.31 11.92, 39.36 2.41 M2.36 51.07 C11.33 42.28, 20.18 28.66, 45 2.02 M2.36 51.07 C11.85 39.11, 23.65 26.29, 45 2.02 M2.75 56.72 C19.12 41.38, 33.14 22.5, 49.99 2.38 M2.75 56.72 C12.44 45.17, 22.22 32.83, 49.99 2.38 M2.49 63.11 C13.52 51.03, 23.59 38.03, 55.63 1.98 M2.49 63.11 C14.66 49.39, 27.1 35.36, 55.63 1.98 M2.88 68.76 C18.57 49.63, 33.62 32.47, 60.62 2.34 M2.88 68.76 C23.02 45.58, 42.55 23.63, 60.62 2.34 M2.62 75.16 C19.19 56.3, 37.65 36.45, 66.26 1.95 M2.62 75.16 C17.85 58.82, 32.72 41.94, 66.26 1.95 M2.36 81.55 C27.47 51.34, 56.37 19.74, 71.25 2.31 M2.36 81.55 C17.14 63.15, 32.34 47.16, 71.25 2.31 M2.76 87.2 C25.91 59.9, 48.55 33.91, 76.89 1.91 M2.76 87.2 C25.05 61.05, 48.31 32.75, 76.89 1.91 M2.49 93.59 C35.22 59.28, 64.87 22, 81.88 2.27 M2.49 93.59 C27.98 65.41, 52.81 38.52, 81.88 2.27 M2.89 99.24 C20.91 78.5, 41.6 58.72, 87.52 1.88 M2.89 99.24 C33.83 62.97, 65.27 27.94, 87.52 1.88 M1.32 107.14 C32.25 74.45, 60.92 40.61, 92.51 2.24 M1.32 107.14 C31.02 75.26, 58.89 42.14, 92.51 2.24 M2.37 112.03 C19.02 90.38, 40.17 69.8, 98.15 1.85 M2.37 112.03 C29.6 80.89, 58.61 49.65, 98.15 1.85 M4.07 116.17 C25.38 91, 44.57 68.59, 103.14 2.21 M4.07 116.17 C40.39 75.92, 75.73 35.02, 103.14 2.21 M5.78 120.3 C37.27 85.28, 67.08 46.52, 108.78 1.81 M5.78 120.3 C26.76 94.19, 48.97 69.65, 108.78 1.81 M8.14 123.68 C34.87 93.25, 60.42 62.52, 113.77 2.17 M8.14 123.68 C48.55 77.99, 88.86 31.31, 113.77 2.17 M11.82 125.55 C45.38 87.09, 81.85 45.95, 119.41 1.78 M11.82 125.55 C46.09 88.04, 78.68 48.81, 119.41 1.78 M15.49 127.42 C44.66 94.84, 72.8 62.85, 124.4 2.14 M15.49 127.42 C56.75 80.86, 96.46 34.12, 124.4 2.14 M18.51 130.04 C41.52 101.51, 68.36 72.66, 130.04 1.74 M18.51 130.04 C56.55 84.12, 96.48 38.21, 130.04 1.74 M23.5 130.4 C62.22 81.19, 104.7 36.81, 135.03 2.1 M23.5 130.4 C59.3 90.25, 94.17 49.76, 135.03 2.1 M27.83 131.52 C67.7 88.24, 108.09 41.26, 140.02 2.46 M27.83 131.52 C67.77 83.45, 110.63 36.34, 140.02 2.46 M32.82 131.88 C68.79 90.92, 105.16 51.72, 145 2.82 M32.82 131.88 C57.94 104.15, 84.87 74.82, 145 2.82 M37.8 132.24 C61.61 104.39, 87.66 71.83, 149.33 3.94 M37.8 132.24 C80.82 84.5, 121.69 35.5, 149.33 3.94 M43.45 131.84 C68.95 102.36, 92.57 74.31, 154.32 4.3 M43.45 131.84 C83.79 84.96, 124.65 38.53, 154.32 4.3 M48.43 132.2 C86.9 86.86, 127.86 43.85, 158 6.17 M48.43 132.2 C75.04 101.43, 100.71 70.46, 158 6.17 M54.08 131.81 C93.1 87.65, 130.36 42.96, 161.67 8.04 M54.08 131.81 C74.37 106.68, 97.67 81.04, 161.67 8.04 M59.06 132.17 C82.41 105.7, 102.83 80.8, 164.03 11.42 M59.06 132.17 C84.94 102.13, 110.67 71.96, 164.03 11.42 M64.71 131.77 C84.43 109.89, 104.66 82.67, 165.74 15.55 M64.71 131.77 C89.46 105.41, 113.36 76.59, 165.74 15.55 M69.69 132.13 C91.08 106.49, 114.13 82.31, 168.1 18.93 M69.69 132.13 C100.64 97.64, 132.16 62.13, 168.1 18.93 M75.34 131.74 C109.73 90.73, 146.4 53.01, 169.15 23.82 M75.34 131.74 C111.38 91.64, 146.98 50.28, 169.15 23.82 M80.32 132.1 C99.85 111.2, 118.94 87.07, 169.55 29.46 M80.32 132.1 C111.54 95.5, 144.26 57.97, 169.55 29.46 M85.97 131.71 C110.78 102.99, 132.63 76.27, 171.25 33.59 M85.97 131.71 C118.84 92.95, 153.6 55.06, 171.25 33.59 M90.95 132.07 C106.26 114.85, 121.15 95.65, 170.99 39.99 M90.95 132.07 C119.01 100.84, 145.28 68, 170.99 39.99 M96.6 131.67 C120.52 104.38, 141.89 79.2, 171.39 45.63 M96.6 131.67 C114.25 112.48, 131.96 91.53, 171.39 45.63 M101.58 132.03 C123.27 106.09, 147.6 76.99, 171.13 52.03 M101.58 132.03 C119.86 110.75, 139.2 88.12, 171.13 52.03 M107.23 131.64 C121.28 115.29, 135.47 98.04, 170.86 58.43 M107.23 131.64 C127.64 107.67, 146.5 86.04, 170.86 58.43 M112.21 132 C134.67 106.07, 156.26 80.98, 171.26 64.07 M112.21 132 C132.47 108.65, 152.59 87.33, 171.26 64.07 M117.86 131.6 C136.08 112.17, 156.06 90.3, 171 70.47 M117.86 131.6 C129.87 117.74, 144.03 101.95, 171 70.47 M122.84 131.96 C134.24 117.29, 145.79 105.4, 170.74 76.87 M122.84 131.96 C141.5 110.58, 158.5 91.14, 170.74 76.87 M128.49 131.57 C145.84 113.36, 162.91 90.88, 171.13 82.51 M128.49 131.57 C139.61 117.75, 153.29 103.99, 171.13 82.51 M133.47 131.93 C142.51 123.6, 151.66 112.58, 170.87 88.91 M133.47 131.93 C141.99 120.76, 151.14 111.23, 170.87 88.91 M138.46 132.29 C147.65 123.99, 153.5 112.73, 170.61 95.31 M138.46 132.29 C147.36 120.67, 156.58 110.42, 170.61 95.31 M144.76 131.14 C148.72 126.28, 157.23 118.8, 171 100.95 M144.76 131.14 C151.69 123.73, 157.86 116.68, 171 100.95 M151.72 129.23 C158.28 122.85, 165.07 111.97, 170.08 108.1 M151.72 129.23 C157.66 120.56, 165.3 114.2, 170.08 108.1" stroke="#ffc9c9" stroke-width="0.5" fill="none"></path><path d="M32 0 M32 0 C54.95 -0.42, 79.46 -0.93, 137.6 0 M32 0 C59.68 -0.85, 86.99 0.36, 137.6 0 M137.6 0 C157.22 1.04, 168.52 9.58, 169.6 32 M137.6 0 C159.9 -0.91, 170.86 9.27, 169.6 32 M169.6 32 C171.4 55.61, 171.17 80.27, 169.6 99.2 M169.6 32 C168.97 51.52, 168.63 70.33, 169.6 99.2 M169.6 99.2 C171.32 121.28, 160.44 133.08, 137.6 131.2 M169.6 99.2 C170.63 121.03, 160.18 130.74, 137.6 131.2 M137.6 131.2 C112.2 131.21, 86.56 131.02, 32 131.2 M137.6 131.2 C116.36 130.16, 92.8 130.79, 32 131.2 M32 131.2 C9.28 132.72, -1.46 121.24, 0 99.2 M32 131.2 C9.62 132.45, -1.58 119.61, 0 99.2 M0 99.2 C-1.34 74.18, -1.58 46.84, 0 32 M0 99.2 C-0.29 84.75, -0.35 68.29, 0 32 M0 32 C-1.75 10.67, 10.87 1.63, 32 0 M0 32 C1.75 8.37, 9.2 2.3, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(472.27200962399604 56.75155824520135) rotate(0 84.22256467938428 0.1688917416583422)"><path d="M-1.08 0.93 C27.2 1.11, 141.37 1.18, 169.53 0.9 M0.55 0.37 C28.76 0.24, 140.67 -0.71, 168.96 -0.75" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(479.195032378884 23.313406196353583) rotate(0 76.34991455078125 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">platform_driver</text></g><g transform="translate(484.8740461168046 62.443103942061555) rotate(0 39.869956970214844 37.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">probe()</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">remove()</text><text x="0" y="50" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">driver</text></g><g stroke-linecap="round" transform="translate(470.6314164491198 177.72327401058698) rotate(0 84.80001831054688 65.59999084472656)"><path d="M7.86 8.16 C7.86 8.16, 7.86 8.16, 7.86 8.16 M7.86 8.16 C7.86 8.16, 7.86 8.16, 7.86 8.16 M3.66 19.09 C6.9 15.52, 13.83 8.88, 18.1 2.48 M3.66 19.09 C6.49 15.86, 10.78 10.71, 18.1 2.48 M2.75 26.24 C12.36 16.48, 16.6 10.36, 24.4 1.33 M2.75 26.24 C7.99 21.35, 12.62 14.52, 24.4 1.33 M2.48 32.64 C12.27 24.36, 17.64 14.95, 30.7 0.18 M2.48 32.64 C11.72 21.43, 19.12 11.46, 30.7 0.18 M2.88 38.28 C13.78 27.27, 21.11 16.86, 34.37 2.05 M2.88 38.28 C10 31.04, 17.42 23.11, 34.37 2.05 M2.62 44.68 C16.09 26.12, 32.73 13.27, 39.36 2.41 M2.62 44.68 C16.43 27.9, 31.38 10.95, 39.36 2.41 M2.36 51.07 C16.27 33.72, 33.07 18.39, 45 2.02 M2.36 51.07 C20.61 31.77, 36.83 12.81, 45 2.02 M2.75 56.72 C19.26 38.03, 35.85 18.14, 49.99 2.38 M2.75 56.72 C14.38 44.56, 24.2 30.85, 49.99 2.38 M2.49 63.11 C16.2 44.58, 33.23 24.76, 55.63 1.98 M2.49 63.11 C22.34 41.09, 40.39 20.59, 55.63 1.98 M2.88 68.76 C18.04 50.55, 36.39 30.34, 60.62 2.34 M2.88 68.76 C20.08 49.63, 35.24 31.8, 60.62 2.34 M2.62 75.16 C20.63 54.79, 35.45 35.33, 66.26 1.95 M2.62 75.16 C21.53 52.59, 40.92 28.44, 66.26 1.95 M2.36 81.55 C27.43 50.17, 55.82 20.6, 71.25 2.31 M2.36 81.55 C26.39 54.02, 49.35 27.51, 71.25 2.31 M2.76 87.2 C29.15 55.79, 57.76 25.8, 76.89 1.91 M2.76 87.2 C26.38 59.75, 49.29 32.64, 76.89 1.91 M2.49 93.59 C27.17 67.85, 47.14 41.72, 81.88 2.27 M2.49 93.59 C24.26 67.27, 47.78 40.84, 81.88 2.27 M2.89 99.24 C26.22 71.6, 47.65 44.6, 87.52 1.88 M2.89 99.24 C23.6 73.98, 44.06 50.13, 87.52 1.88 M1.32 107.14 C26.09 76.76, 52.33 46.77, 92.51 2.24 M1.32 107.14 C37.13 64.53, 73.67 23.85, 92.51 2.24 M2.37 112.03 C26.39 84.82, 52.28 58.84, 98.15 1.85 M2.37 112.03 C39.33 69, 76.57 25.54, 98.15 1.85 M4.07 116.17 C25.72 91.43, 48.79 64.51, 103.14 2.21 M4.07 116.17 C41.57 72.58, 78.76 28.04, 103.14 2.21 M5.78 120.3 C40.73 81.06, 72.9 43.3, 108.78 1.81 M5.78 120.3 C34.38 86.37, 61.64 53.18, 108.78 1.81 M8.14 123.68 C43.08 81.63, 78.29 44.51, 113.77 2.17 M8.14 123.68 C48.57 77.44, 89.3 30.37, 113.77 2.17 M11.82 125.55 C46.57 82.52, 82.03 43.8, 119.41 1.78 M11.82 125.55 C39.56 94.54, 66.19 62.44, 119.41 1.78 M15.49 127.42 C58.22 76.3, 102.06 29.59, 124.4 2.14 M15.49 127.42 C53.48 83.32, 90.82 39.59, 124.4 2.14 M18.51 130.04 C43.82 101.71, 70.84 69.95, 130.04 1.74 M18.51 130.04 C50.87 93.78, 82.28 55.69, 130.04 1.74 M23.5 130.4 C64 81.04, 107.61 31.2, 135.03 2.1 M23.5 130.4 C54.69 95.06, 85.91 58.47, 135.03 2.1 M27.83 131.52 C70.85 84.01, 114.68 32.26, 140.02 2.46 M27.83 131.52 C70.69 81.54, 114.72 32.04, 140.02 2.46 M32.82 131.88 C62.04 97.82, 87.39 65.53, 145 2.82 M32.82 131.88 C75.2 84.51, 117.84 37.14, 145 2.82 M37.8 132.24 C73.17 91.72, 109.38 50.42, 149.33 3.94 M37.8 132.24 C78.61 87.38, 116.68 40.44, 149.33 3.94 M43.45 131.84 C79.55 89.79, 114.49 52.38, 154.32 4.3 M43.45 131.84 C72.36 99.01, 100.37 64.65, 154.32 4.3 M48.43 132.2 C88.03 87.58, 128.46 41.74, 158 6.17 M48.43 132.2 C77.4 99.91, 105.56 68.01, 158 6.17 M54.08 131.81 C85.64 97.52, 113.97 61.48, 161.67 8.04 M54.08 131.81 C76.12 105.28, 97.94 78.78, 161.67 8.04 M59.06 132.17 C101.92 86.17, 142.53 38.7, 164.03 11.42 M59.06 132.17 C96.47 89.1, 133.18 45.92, 164.03 11.42 M64.71 131.77 C87.94 107.77, 107.5 84.28, 165.74 15.55 M64.71 131.77 C95.75 95.21, 126.93 59.15, 165.74 15.55 M69.69 132.13 C93.82 103.06, 118.78 74.72, 168.1 18.93 M69.69 132.13 C104.37 91.61, 138.35 53.51, 168.1 18.93 M75.34 131.74 C109.55 91.81, 140.71 53.83, 169.15 23.82 M75.34 131.74 C98.5 103.53, 124.12 75.4, 169.15 23.82 M80.32 132.1 C100.93 109.54, 116.9 90.86, 169.55 29.46 M80.32 132.1 C113.12 95.44, 145.01 58.94, 169.55 29.46 M85.97 131.71 C115.59 100.3, 142.82 66.31, 171.25 33.59 M85.97 131.71 C119.26 92.45, 153.28 54.06, 171.25 33.59 M90.95 132.07 C111.23 109.44, 130.27 89.63, 170.99 39.99 M90.95 132.07 C117.91 100.16, 145.66 69.03, 170.99 39.99 M96.6 131.67 C121.46 104.98, 145.95 73.93, 171.39 45.63 M96.6 131.67 C118.4 107.68, 139.1 82.37, 171.39 45.63 M101.58 132.03 C125.93 104.21, 145.91 79.23, 171.13 52.03 M101.58 132.03 C120.26 111.75, 139.58 90.22, 171.13 52.03 M107.23 131.64 C129.91 104.26, 152.25 80.01, 170.86 58.43 M107.23 131.64 C127.73 110.08, 147.47 86.17, 170.86 58.43 M112.21 132 C125.94 114.22, 142.33 96.88, 171.26 64.07 M112.21 132 C129.89 109.61, 149.69 88.6, 171.26 64.07 M117.86 131.6 C134.31 111.93, 150.4 95.43, 171 70.47 M117.86 131.6 C132.9 115.08, 147.14 97.88, 171 70.47 M122.84 131.96 C137.77 112.33, 157.18 93.08, 170.74 76.87 M122.84 131.96 C138.57 113.66, 153.74 94.07, 170.74 76.87 M128.49 131.57 C141.12 115.55, 155.16 98.44, 171.13 82.51 M128.49 131.57 C137.45 119.84, 147.84 110.01, 171.13 82.51 M133.47 131.93 C142.99 117.14, 158.07 106.75, 170.87 88.91 M133.47 131.93 C146.62 117.16, 158.75 102.66, 170.87 88.91 M138.46 132.29 C147.4 118.83, 159.82 109.37, 170.61 95.31 M138.46 132.29 C145.02 124.66, 150.94 116.75, 170.61 95.31 M144.76 131.14 C149.3 125.06, 156.43 117.67, 171 100.95 M144.76 131.14 C151.17 122.72, 156.98 116.45, 171 100.95 M151.72 129.23 C157.62 121.2, 164.05 116.22, 170.08 108.1 M151.72 129.23 C157.9 121.98, 163.46 115.87, 170.08 108.1" stroke="#b2f2bb" stroke-width="0.5" fill="none"></path><path d="M32 0 M32 0 C69.68 -1.42, 109.2 -1.66, 137.6 0 M32 0 C65.98 0.09, 98.71 1.39, 137.6 0 M137.6 0 C158.23 1.8, 170.88 10.17, 169.6 32 M137.6 0 C158.74 -1.28, 171 9.6, 169.6 32 M169.6 32 C169.48 57.15, 170.11 80.99, 169.6 99.2 M169.6 32 C169.33 54.21, 170.35 74.46, 169.6 99.2 M169.6 99.2 C170.47 120.97, 157.01 132.73, 137.6 131.2 M169.6 99.2 C167.93 122.13, 158.62 129.44, 137.6 131.2 M137.6 131.2 C108.88 130.58, 80.71 133.16, 32 131.2 M137.6 131.2 C97.22 132.02, 59.36 131.71, 32 131.2 M32 131.2 C12.48 132.84, 0.67 119.48, 0 99.2 M32 131.2 C12.09 131.06, 1.25 121.96, 0 99.2 M0 99.2 C-0.3 72.94, -1.45 49.65, 0 32 M0 99.2 C0.47 82.21, 0.71 64.14, 0 32 M0 32 C-1.46 12.07, 12.08 -1.66, 32 0 M0 32 C-0.99 11.28, 8.9 -2.13, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(471.6314164491198 223.72327401058698) rotate(0 84.31816919445993 -0.6083812666777817)"><path d="M-1.08 -0.41 C27.32 -0.53, 141.23 -0.97, 169.72 -0.71 M0.55 -1.68 C28.94 -1.65, 141.06 0.28, 169.25 0.46" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(489.5631833815702 186.42180761163314) rotate(0 64.13993072509766 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">gmac_probe()</text></g><g transform="translate(472.646691667641 234.21024613215405) rotate(0 77.27992248535156 25)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">init/alloc/select</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">net_device_ops</text></g><g stroke-linecap="round" transform="translate(223.52903059998332 176.80470533292913) rotate(0 110.32036865248546 80.71586969443257)"><path d="M7.86 8.16 C7.86 8.16, 7.86 8.16, 7.86 8.16 M7.86 8.16 C7.86 8.16, 7.86 8.16, 7.86 8.16 M3.66 19.09 C7.04 15.32, 13.38 11.2, 18.1 2.48 M3.66 19.09 C7.93 14.7, 11.85 9.72, 18.1 2.48 M2.75 26.24 C7.55 20.83, 13.69 11.85, 24.4 1.33 M2.75 26.24 C10.94 15.94, 18.98 6.47, 24.4 1.33 M2.48 32.64 C13.82 22.41, 24.29 8.12, 30.7 0.18 M2.48 32.64 C13.13 21.58, 22.85 11.29, 30.7 0.18 M2.88 38.28 C13.45 27.1, 25.31 15.22, 34.37 2.05 M2.88 38.28 C11.36 26.94, 21.21 16.71, 34.37 2.05 M2.62 44.68 C14.91 33.55, 25.29 18.58, 39.36 2.41 M2.62 44.68 C15.49 29.6, 28.75 12.76, 39.36 2.41 M2.36 51.07 C17.23 35.71, 29.4 21, 45 2.02 M2.36 51.07 C16.57 33.72, 31.83 15.71, 45 2.02 M2.75 56.72 C16.7 42.92, 27.9 26.52, 49.99 2.38 M2.75 56.72 C18.61 38.74, 33.64 21.75, 49.99 2.38 M2.49 63.11 C15.96 48.19, 24.46 33.95, 55.63 1.98 M2.49 63.11 C19 43.01, 36.16 24.54, 55.63 1.98 M2.23 69.51 C16.68 52.54, 34.92 32.7, 60.62 2.34 M2.23 69.51 C25.13 42.43, 47.16 17.53, 60.62 2.34 M2.62 75.16 C24.09 48.59, 46.45 21.66, 66.26 1.95 M2.62 75.16 C16.39 61.15, 28.37 45.54, 66.26 1.95 M2.36 81.55 C18.97 61.39, 37.06 38.01, 71.25 2.31 M2.36 81.55 C26.4 51.34, 53.68 23.21, 71.25 2.31 M2.1 87.95 C22.74 63.45, 47.85 39.26, 76.89 1.91 M2.1 87.95 C18.93 69.32, 35.59 48.86, 76.89 1.91 M2.49 93.59 C29.61 62.42, 59.09 31.32, 81.88 2.27 M2.49 93.59 C27.41 66.26, 51.75 38, 81.88 2.27 M2.23 99.99 C31.02 68.87, 56.61 35.14, 87.52 1.88 M2.23 99.99 C20.04 79.11, 39.3 57.39, 87.52 1.88 M1.97 106.39 C19.78 83.82, 41.81 58.82, 92.51 2.24 M1.97 106.39 C24.88 78.35, 47.28 53.23, 92.51 2.24 M2.37 112.03 C33.9 75.8, 67.61 39.51, 98.15 1.85 M2.37 112.03 C28.82 82.99, 54.17 53.04, 98.15 1.85 M2.1 118.43 C39.25 75.11, 73.29 33.61, 103.14 2.21 M2.1 118.43 C34.04 82.67, 63.25 46.93, 103.14 2.21 M2.5 124.07 C41.08 78.01, 81.98 29.89, 108.78 1.81 M2.5 124.07 C28.82 92.27, 57.63 58.67, 108.78 1.81 M1.58 131.23 C23.95 106.64, 46.13 81.39, 113.77 2.17 M1.58 131.23 C41.47 85.44, 80.8 39.73, 113.77 2.17 M2.63 136.11 C36.76 94.05, 71.51 55.95, 119.41 1.78 M2.63 136.11 C40.22 91.53, 79.65 47.14, 119.41 1.78 M3.03 141.76 C48.84 91.13, 95.09 37.13, 124.4 2.14 M3.03 141.76 C45.32 92.3, 88.59 44.08, 124.4 2.14 M4.73 145.89 C42.03 102.04, 81.04 60.74, 130.04 1.74 M4.73 145.89 C33.9 113.93, 59.92 83.37, 130.04 1.74 M7.1 149.27 C42.97 107.01, 77.26 65.69, 135.03 2.1 M7.1 149.27 C37.02 113.43, 70.24 74.98, 135.03 2.1 M8.15 154.16 C58.88 95.16, 106.75 39.29, 140.67 1.71 M8.15 154.16 C46.72 108.96, 87.63 61.73, 140.67 1.71 M11.82 156.03 C49.51 113.95, 86.58 69.44, 145.66 2.07 M11.82 156.03 C43.05 120.4, 75.06 83.64, 145.66 2.07 M15.5 157.9 C51.56 115.64, 88.83 74.47, 150.65 2.43 M15.5 157.9 C66.29 100.46, 116.37 43.7, 150.65 2.43 M18.52 160.52 C62.43 107.5, 108.36 56.64, 156.29 2.03 M18.52 160.52 C61.48 110.28, 106.66 59.12, 156.29 2.03 M23.5 160.88 C67.06 109.52, 114.61 57.55, 161.28 2.39 M23.5 160.88 C57.66 120.93, 92.42 80.57, 161.28 2.39 M28.49 161.24 C73.35 106.01, 121.19 53.38, 166.92 2 M28.49 161.24 C73.86 108.18, 121.08 55.51, 166.92 2 M32.82 162.36 C68.34 121.68, 101.63 84.85, 171.91 2.36 M32.82 162.36 C86.25 99.5, 141.21 35.88, 171.91 2.36 M38.46 161.96 C66.94 127.3, 97.78 91.53, 177.55 1.96 M38.46 161.96 C85.36 106.73, 133.44 52.4, 177.55 1.96 M43.45 162.32 C88.49 111.31, 134.41 58.25, 182.54 2.32 M43.45 162.32 C80.5 121, 117.47 79.13, 182.54 2.32 M49.09 161.93 C83.28 124.4, 114.06 86.12, 189.49 0.42 M49.09 161.93 C79.26 126.18, 110.26 89.2, 189.49 0.42 M54.08 162.29 C81.72 126.18, 111.23 95.51, 193.82 1.54 M54.08 162.29 C104.66 105.1, 154.4 47.03, 193.82 1.54 M59.72 161.89 C90.86 126.26, 121.48 89.92, 198.81 1.9 M59.72 161.89 C98.85 115.74, 140.02 68.83, 198.81 1.9 M64.71 162.25 C112.3 108.77, 157.64 51.26, 203.14 3.01 M64.71 162.25 C93.03 128.19, 120.03 95.87, 203.14 3.01 M69.7 162.61 C100.57 127.75, 132.48 92.28, 206.81 4.88 M69.7 162.61 C107.56 118.92, 145.29 75.87, 206.81 4.88 M75.34 162.22 C119.72 110.41, 163.61 59.21, 210.49 6.75 M75.34 162.22 C121.47 106.12, 168.8 53.28, 210.49 6.75 M80.33 162.58 C111.35 127.3, 139.65 94.51, 213.51 9.37 M80.33 162.58 C126.45 110.06, 173.18 55.37, 213.51 9.37 M85.97 162.18 C132.17 107.73, 177.12 58.63, 215.87 12.75 M85.97 162.18 C133.2 107.7, 180.31 53.56, 215.87 12.75 M90.96 162.54 C142.17 105.48, 192.58 46.75, 218.23 16.13 M90.96 162.54 C125.93 122.49, 160.94 81.64, 218.23 16.13 M96.6 162.15 C140.98 108.61, 189.89 57.35, 220.6 19.51 M96.6 162.15 C127.52 128.32, 156.67 94.25, 220.6 19.51 M101.59 162.51 C136.87 124.39, 167.29 87.78, 220.99 25.15 M101.59 162.51 C135.96 124.49, 171.25 84.49, 220.99 25.15 M107.23 162.12 C146.84 121.37, 183.68 75.83, 222.04 30.04 M107.23 162.12 C130.85 133.42, 155.58 105.45, 222.04 30.04 M112.22 162.48 C154.68 109.63, 201.87 58.55, 223.75 34.18 M112.22 162.48 C135.39 135.35, 158.62 108.36, 223.75 34.18 M117.86 162.08 C151.09 121.6, 188.16 83.15, 223.49 40.57 M117.86 162.08 C151 122.07, 185.72 82.85, 223.49 40.57 M122.85 162.44 C149.2 132.62, 176.98 104.23, 223.23 46.97 M122.85 162.44 C151.77 128.05, 181.82 94.78, 223.23 46.97 M128.49 162.05 C151.12 134.46, 173.84 109.24, 223.62 52.61 M128.49 162.05 C150.98 134.42, 173.52 110.49, 223.62 52.61 M133.48 162.41 C163.86 127.78, 193.86 97.61, 223.36 59.01 M133.48 162.41 C153.64 136.91, 175.83 112.55, 223.36 59.01 M139.12 162.01 C166.03 127.16, 198.33 95.1, 223.75 64.65 M139.12 162.01 C161.46 136.71, 182.27 113.31, 223.75 64.65 M144.11 162.37 C164.22 141.08, 184.95 119.01, 223.49 71.05 M144.11 162.37 C171.07 131.15, 198.88 100.36, 223.49 71.05 M149.75 161.98 C168.97 139.26, 187.44 120.59, 223.23 77.45 M149.75 161.98 C172.22 135.12, 195.56 109.05, 223.23 77.45 M154.74 162.34 C170.93 143.09, 188.57 126.36, 223.63 83.09 M154.74 162.34 C179.63 133.46, 202.23 106.72, 223.63 83.09 M160.38 161.94 C174.43 146.84, 184.84 133.68, 223.36 89.49 M160.38 161.94 C180.79 136.46, 202.18 113.83, 223.36 89.49 M165.37 162.3 C185.25 140.37, 201.13 123.42, 223.76 95.13 M165.37 162.3 C179.11 148.31, 191.65 134.03, 223.76 95.13 M171.01 161.91 C190.82 139.6, 209.31 120.42, 223.5 101.53 M171.01 161.91 C187.11 142.53, 202.35 125.32, 223.5 101.53 M176 162.27 C186.07 152.89, 193.96 139.76, 223.24 107.93 M176 162.27 C190.17 144.1, 205.59 127.47, 223.24 107.93 M181.64 161.87 C194.96 147.38, 206.27 133.81, 223.63 113.57 M181.64 161.87 C191.6 150.81, 201.14 140.1, 223.63 113.57 M186.63 162.23 C198.11 150.82, 207.65 134.94, 223.37 119.97 M186.63 162.23 C197.63 149.5, 206.17 137.67, 223.37 119.97 M190.96 163.35 C201.16 151.72, 209.99 140.72, 223.76 125.61 M190.96 163.35 C200.14 152.68, 210.7 139.94, 223.76 125.61 M197.26 162.2 C205.05 152.47, 214.17 145.03, 223.5 132.01 M197.26 162.2 C204.96 151.7, 214.66 142.45, 223.5 132.01 M204.21 160.3 C207.69 154.75, 215.83 147.46, 218.65 143.69 M204.21 160.3 C206.44 157.48, 210.61 152.57, 218.65 143.69" stroke="#b2f2bb" stroke-width="0.5" fill="none"></path><path d="M32 0 M32 0 C83.53 0.15, 134.98 -0.41, 188.64 0 M32 0 C82.92 0.17, 133.14 -0.32, 188.64 0 M188.64 0 C209.6 -1.57, 218.76 9.5, 220.64 32 M188.64 0 C211.49 1.51, 221.96 12.8, 220.64 32 M220.64 32 C219.49 71.47, 219.3 108.26, 220.64 129.43 M220.64 32 C221.44 65.2, 221.14 100.55, 220.64 129.43 M220.64 129.43 C222.2 149.27, 208.83 159.66, 188.64 161.43 M220.64 129.43 C219.24 152.37, 211.61 159.51, 188.64 161.43 M188.64 161.43 C156.68 163.03, 122.23 161.69, 32 161.43 M188.64 161.43 C127 161.94, 63.12 161.24, 32 161.43 M32 161.43 C11 160.28, 1.28 149.56, 0 129.43 M32 161.43 C12.4 161.83, -2.01 149.78, 0 129.43 M0 129.43 C-0.68 102.97, 1.11 77.06, 0 32 M0 129.43 C-0.95 104.35, -0.78 81.12, 0 32 M0 32 C-0.14 10.13, 8.88 -1.85, 32 0 M0 32 C-2.05 8.78, 9.83 0.11, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(224.74377107824782 222.01941585660592) rotate(0 110.02608476772176 0.6552586036582397)"><path d="M-0.56 -0.63 C36.31 -0.56, 183.87 0.15, 220.61 0.61 M1.35 1.65 C38.17 1.86, 183.77 2.07, 220.07 1.86" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(256.0509650660957 188.58132371693438) rotate(0 77.27992248535159 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">net_device_ops</text></g><g transform="translate(233.95207099058783 229.1832894578087) rotate(0 97.29989624023435 50)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">open()</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">xmit()</text><text x="0" y="50" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">release()</text><text x="0" y="75" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">set_mac_address()</text></g><g stroke-linecap="round" transform="translate(10.885590403445889 376.75785321619213) rotate(0 145.63079921895803 82.09008134611656)"><path d="M7.86 8.16 C7.86 8.16, 7.86 8.16, 7.86 8.16 M7.86 8.16 C7.86 8.16, 7.86 8.16, 7.86 8.16 M3.66 19.09 C5.46 13.99, 8.98 12.55, 18.1 2.48 M3.66 19.09 C8.94 13.24, 12.17 8.95, 18.1 2.48 M2.75 26.24 C12.14 15.12, 17.25 7.17, 24.4 1.33 M2.75 26.24 C8.21 18.75, 14.77 11.37, 24.4 1.33 M2.48 32.64 C12.97 21.22, 24.86 8.01, 30.7 0.18 M2.48 32.64 C9.79 25.52, 16.07 17.01, 30.7 0.18 M2.88 38.28 C12.23 29.65, 22.85 17.41, 34.37 2.05 M2.88 38.28 C14.48 23.96, 28.74 9.5, 34.37 2.05 M2.62 44.68 C11.08 35.67, 17.89 28.14, 39.36 2.41 M2.62 44.68 C13.77 32.03, 26.54 18.72, 39.36 2.41 M2.36 51.07 C13.95 38.48, 26.83 25.48, 45 2.02 M2.36 51.07 C11 40.66, 19.57 30.26, 45 2.02 M2.75 56.72 C20.48 35.69, 37.03 19.57, 49.99 2.38 M2.75 56.72 C15.48 42.01, 28.81 27.68, 49.99 2.38 M2.49 63.11 C19.81 42.34, 35.78 23.65, 55.63 1.98 M2.49 63.11 C16.08 45.75, 31.2 30.1, 55.63 1.98 M2.88 68.76 C15.65 52.26, 29.74 36.04, 60.62 2.34 M2.88 68.76 C18.59 53.18, 31.77 35.77, 60.62 2.34 M2.62 75.16 C19.11 55.96, 34.45 36.75, 66.26 1.95 M2.62 75.16 C25.34 51.64, 45.09 26.7, 66.26 1.95 M2.36 81.55 C16.84 63.06, 35.89 40.97, 71.25 2.31 M2.36 81.55 C18.64 64.41, 33.03 45.94, 71.25 2.31 M2.76 87.2 C19.95 66.38, 37.45 44.01, 76.89 1.91 M2.76 87.2 C31.39 54.61, 60.02 20.32, 76.89 1.91 M2.49 93.59 C26.11 67.38, 51.31 35.8, 81.88 2.27 M2.49 93.59 C33.13 58.64, 64.43 24.52, 81.88 2.27 M2.89 99.24 C20.21 78.71, 37.33 56.34, 87.52 1.88 M2.89 99.24 C24.17 74.41, 44.65 50.47, 87.52 1.88 M2.63 105.64 C38.58 67.51, 73.41 25.11, 92.51 2.24 M2.63 105.64 C34.67 68.4, 67.93 30.84, 92.51 2.24 M2.37 112.03 C28.18 79.4, 59.63 45.17, 98.15 1.85 M2.37 112.03 C35.88 75.43, 67.58 39.82, 98.15 1.85 M2.76 117.68 C39.04 75.98, 79.77 29.97, 103.14 2.21 M2.76 117.68 C23.27 95.51, 43.57 70.89, 103.14 2.21 M2.5 124.07 C45.72 76.18, 88.28 29.33, 108.78 1.81 M2.5 124.07 C35.51 87.14, 69.91 48.07, 108.78 1.81 M2.89 129.72 C44.4 83.09, 87.69 35.27, 113.77 2.17 M2.89 129.72 C44.32 83.58, 87.85 33.92, 113.77 2.17 M2.63 136.11 C46.93 86.54, 88.61 37.29, 119.41 1.78 M2.63 136.11 C34.86 99.12, 67.32 61.95, 119.41 1.78 M3.03 141.76 C30.63 108.74, 57.77 78.88, 124.4 2.14 M3.03 141.76 C50.32 87.22, 95.9 33.52, 124.4 2.14 M4.73 145.89 C39.62 105.97, 71.81 64.89, 130.04 1.74 M4.73 145.89 C44.99 96.96, 86.64 49.33, 130.04 1.74 M4.47 152.29 C50.61 98.95, 96.91 44.93, 135.03 2.1 M4.47 152.29 C49.54 100.57, 93.47 50.8, 135.03 2.1 M7.49 154.91 C51.79 103.73, 95.95 54.84, 140.67 1.71 M7.49 154.91 C36.24 121.71, 64.54 89.83, 140.67 1.71 M10.51 157.54 C38.91 125.96, 66.43 94.21, 145.66 2.07 M10.51 157.54 C64.79 95.77, 118.44 34.1, 145.66 2.07 M13.53 160.16 C58.44 107.27, 103.72 55.47, 150.65 2.43 M13.53 160.16 C50.27 120.11, 85.88 76.61, 150.65 2.43 M17.2 162.03 C64.32 108.43, 111.11 57.23, 156.29 2.03 M17.2 162.03 C62.55 111.63, 107.61 58.47, 156.29 2.03 M21.53 163.15 C55.56 123.84, 89 84.29, 161.28 2.39 M21.53 163.15 C63.2 115.46, 104.05 68.62, 161.28 2.39 M25.87 164.26 C69.47 116.45, 111.62 68.1, 166.92 2 M25.87 164.26 C71.29 111.03, 116.76 58.93, 166.92 2 M30.85 164.62 C64.2 128.54, 98.22 91.44, 171.91 2.36 M30.85 164.62 C73.64 115.1, 116.13 67.5, 171.91 2.36 M34.53 166.49 C68.95 125.68, 106.21 83.07, 177.55 1.96 M34.53 166.49 C64.12 128.65, 97.49 93.55, 177.55 1.96 M40.17 166.1 C96.78 101.88, 152.8 35.24, 182.54 2.32 M40.17 166.1 C84.85 114.9, 131.59 63.91, 182.54 2.32 M45.16 166.46 C84.82 119.01, 126.6 73.05, 188.18 1.93 M45.16 166.46 C80.7 125.78, 116.44 82.72, 188.18 1.93 M50.8 166.06 C86.38 123.63, 118.91 83.66, 193.17 2.29 M50.8 166.06 C80.8 133.51, 109.76 98.94, 193.17 2.29 M55.79 166.42 C97.16 117.56, 141.89 69.1, 198.81 1.9 M55.79 166.42 C99.3 115.67, 142.19 67.67, 198.81 1.9 M60.77 166.78 C96.74 125.14, 132.89 85.28, 203.8 2.26 M60.77 166.78 C97.44 125.02, 133.91 83.68, 203.8 2.26 M66.42 166.39 C116.05 111.46, 161.66 57.08, 209.44 1.86 M66.42 166.39 C102.72 126.25, 138.63 83.56, 209.44 1.86 M71.4 166.75 C109.29 124.72, 145.05 82.41, 214.43 2.22 M71.4 166.75 C125.66 106.27, 179.32 45.55, 214.43 2.22 M77.05 166.35 C112.5 129.22, 145.13 87.8, 220.07 1.83 M77.05 166.35 C112.95 127.92, 146.2 88.4, 220.07 1.83 M82.04 166.71 C120.76 120.04, 163.85 70.96, 225.06 2.19 M82.04 166.71 C121.85 118.94, 163.82 70.48, 225.06 2.19 M87.68 166.32 C117.54 132.54, 147.82 97.51, 230.7 1.79 M87.68 166.32 C116.74 134.22, 145.09 99.95, 230.7 1.79 M92.67 166.68 C138.82 113.19, 187.54 59.02, 235.69 2.15 M92.67 166.68 C143.91 106.65, 196.01 45.42, 235.69 2.15 M98.31 166.28 C134.25 125.01, 168.52 83.95, 241.33 1.76 M98.31 166.28 C144.14 113.86, 189.22 62.82, 241.33 1.76 M103.3 166.64 C157.81 107.74, 207.91 46.39, 246.32 2.12 M103.3 166.64 C158.45 102.84, 214.41 38.21, 246.32 2.12 M108.94 166.25 C151.11 116.19, 191.39 68.86, 251.96 1.72 M108.94 166.25 C163.58 103.13, 217.27 40.44, 251.96 1.72 M113.93 166.61 C161.61 111.28, 209.65 58.37, 256.95 2.08 M113.93 166.61 C167.84 106.28, 222.06 45.07, 256.95 2.08 M119.57 166.21 C159.88 120.35, 200.09 72.58, 261.93 2.44 M119.57 166.21 C148.84 132.54, 180.19 98.72, 261.93 2.44 M124.56 166.57 C178.49 105.66, 229.74 44.6, 268.23 1.29 M124.56 166.57 C175.57 110.31, 225.13 52.36, 268.23 1.29 M130.2 166.18 C181.24 111.03, 229.01 52.56, 271.91 3.16 M130.2 166.18 C168.65 124.45, 206.49 80.13, 271.91 3.16 M135.19 166.54 C184.54 110.54, 233.07 55.75, 276.24 4.28 M135.19 166.54 C188.32 107.67, 240.17 47.1, 276.24 4.28 M140.83 166.15 C189.76 109.93, 237.11 55.69, 279.91 6.15 M140.83 166.15 C168.12 134.63, 196.95 100.57, 279.91 6.15 M145.82 166.51 C195.11 109.28, 243.94 54.18, 282.93 8.77 M145.82 166.51 C191.96 115.34, 234.96 64.95, 282.93 8.77 M151.46 166.11 C201.12 112.76, 246.46 55.95, 285.95 11.4 M151.46 166.11 C195.58 116.51, 240.34 65.13, 285.95 11.4 M156.45 166.47 C187.96 133.09, 217.66 96.51, 288.97 14.02 M156.45 166.47 C200.83 115.46, 243.98 65.58, 288.97 14.02 M162.09 166.08 C212.37 109.15, 259.8 50.4, 290.02 18.91 M162.09 166.08 C209.95 111.3, 257.75 56.96, 290.02 18.91 M167.08 166.44 C190.76 137.73, 216.59 110.34, 291.07 23.8 M167.08 166.44 C206.68 120.79, 244.67 77.64, 291.07 23.8 M172.06 166.8 C202.58 132.41, 234.59 95.18, 291.47 29.44 M172.06 166.8 C202.87 130.26, 235.24 93.47, 291.47 29.44 M177.71 166.4 C207.28 129.79, 237.28 94.64, 293.17 33.57 M177.71 166.4 C205.36 133.68, 233.06 103.69, 293.17 33.57 M182.69 166.76 C225.3 119.56, 268.96 71.17, 292.91 39.97 M182.69 166.76 C224.83 118.91, 267.78 68.89, 292.91 39.97 M188.34 166.37 C228.59 117.93, 270.3 71.2, 293.31 45.61 M188.34 166.37 C216.28 133.12, 246.39 97.77, 293.31 45.61 M193.32 166.73 C220.93 135.45, 250.07 104.07, 293.04 52.01 M193.32 166.73 C226.93 128.7, 260.38 89.86, 293.04 52.01 M198.97 166.33 C227.95 132.08, 261.16 97.54, 293.44 57.66 M198.97 166.33 C222.38 136.25, 247.43 108.36, 293.44 57.66 M203.95 166.69 C230.35 134.38, 257.38 104.08, 293.18 64.05 M203.95 166.69 C233.74 131.3, 264.41 97.4, 293.18 64.05 M209.6 166.3 C241.72 129.24, 276.76 91.18, 292.92 70.45 M209.6 166.3 C226.94 144.47, 245.46 124.15, 292.92 70.45 M214.58 166.66 C243.88 133.58, 271.97 103.34, 293.31 76.09 M214.58 166.66 C232.77 145.12, 250.93 124.39, 293.31 76.09 M220.23 166.26 C241.81 141.17, 260.98 119.79, 293.05 82.49 M220.23 166.26 C249.44 132.9, 277.29 99.89, 293.05 82.49 M225.21 166.62 C248.64 143.18, 269.82 116.45, 293.44 88.13 M225.21 166.62 C245.19 143.67, 264.1 120.07, 293.44 88.13 M230.86 166.23 C246.68 146.65, 264.2 126.92, 293.18 94.53 M230.86 166.23 C247.69 144.76, 266.37 125.09, 293.18 94.53 M235.84 166.59 C250.55 148.75, 264.51 132.43, 292.92 100.93 M235.84 166.59 C249.01 151.88, 260.14 138.6, 292.92 100.93 M241.49 166.2 C263.43 144.24, 282.63 118.09, 293.32 106.57 M241.49 166.2 C252.81 153.79, 264.03 141.52, 293.32 106.57 M246.47 166.56 C254.92 156.74, 265.9 144.74, 293.05 112.97 M246.47 166.56 C263.18 148.84, 276.81 131.33, 293.05 112.97 M252.12 166.16 C262.34 154.34, 276.1 139.19, 293.45 118.61 M252.12 166.16 C264.26 152.31, 275.67 140.82, 293.45 118.61 M257.1 166.52 C271.99 152.02, 285.08 136.36, 293.19 125.01 M257.1 166.52 C270.04 149.53, 284.33 135.6, 293.19 125.01 M262.09 166.88 C273.12 155.55, 283.25 145.03, 291.61 132.92 M262.09 166.88 C269.5 157.79, 279.14 147.98, 291.61 132.92 M268.39 165.73 C277.04 154.99, 284.47 147.33, 290.7 140.07 M268.39 165.73 C276.71 157.78, 283.21 147.87, 290.7 140.07 M278.63 160.05 C282.93 157.18, 285.19 153.26, 287.81 149.49 M278.63 160.05 C282.66 155.98, 285.32 151.91, 287.81 149.49" stroke="#a5d8ff" stroke-width="0.5" fill="none"></path><path d="M32 0 M32 0 C93.74 0.35, 154.32 1.24, 259.26 0 M32 0 C78.13 -1.15, 122.36 -1.39, 259.26 0 M259.26 0 C278.7 -1.72, 290.14 12.29, 291.26 32 M259.26 0 C280.1 2.19, 290.33 12.41, 291.26 32 M291.26 32 C293.04 55.06, 292.17 74.16, 291.26 132.18 M291.26 32 C291.36 55.65, 292.35 80.38, 291.26 132.18 M291.26 132.18 C289.68 152.67, 281.11 164.82, 259.26 164.18 M291.26 132.18 C292.99 153.41, 280.06 162.66, 259.26 164.18 M259.26 164.18 C176.49 161.91, 94.7 162.21, 32 164.18 M259.26 164.18 C189.32 165.81, 118.97 165.8, 32 164.18 M32 164.18 C9.79 163.37, -0.25 154.41, 0 132.18 M32 164.18 C12.89 165.33, 0.02 153, 0 132.18 M0 132.18 C-0.89 102.12, 0.71 74.45, 0 32 M0 132.18 C-0.71 103.73, -0.75 76.41, 0 32 M0 32 C-1.09 10.79, 9.83 -1.3, 32 0 M0 32 C-1.86 11.91, 10.72 0.75, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(11.241309059476492 422.7579131253679) rotate(0 137.7806213245165 -0.13352363066991302)"><path d="M0.14 -0.21 C45.85 -0.13, 228.58 1.29, 274.41 1.14 M-1.24 -1.37 C44.84 -1.64, 230.87 -0.55, 276.8 -0.39" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(29.39906491894041 386.27703394705867) rotate(0 81.0199203491211 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">r4l_gmac_open()</text></g><g transform="translate(19.119568205442732 431.0358082299917) rotate(0 136.30987548828125 50)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">r4l_gmac_init_phy()</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">alloc_dma_desc_resource()</text><text x="0" y="50" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">init_dma_desc_rings()</text><text x="0" y="75" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">dwmac_setup()</text></g><g stroke-linecap="round" transform="translate(355.3404399182814 375.7763911437274) rotate(0 170.98029628415372 94.06499699535038)"><path d="M7.86 8.16 C7.86 8.16, 7.86 8.16, 7.86 8.16 M7.86 8.16 C7.86 8.16, 7.86 8.16, 7.86 8.16 M3.66 19.09 C7.49 11.95, 13.23 7.11, 18.1 2.48 M3.66 19.09 C7.79 15.44, 10.08 11.97, 18.1 2.48 M2.75 26.24 C11.98 16.68, 19.73 7.11, 24.4 1.33 M2.75 26.24 C9.04 19.11, 14.84 13.41, 24.4 1.33 M2.48 32.64 C10.54 22.13, 20.82 13.34, 30.7 0.18 M2.48 32.64 C10.55 22.89, 18.09 15.13, 30.7 0.18 M2.88 38.28 C12.79 30.06, 18.94 17.88, 34.37 2.05 M2.88 38.28 C12.53 27.7, 22.83 15.51, 34.37 2.05 M2.62 44.68 C14.58 31.98, 28.12 16.92, 39.36 2.41 M2.62 44.68 C13.15 32.74, 24.11 21.19, 39.36 2.41 M2.36 51.07 C11.71 38.56, 23.07 27.18, 45 2.02 M2.36 51.07 C15.35 36.84, 27.5 22.23, 45 2.02 M2.75 56.72 C19.96 37.63, 37.4 16.04, 49.99 2.38 M2.75 56.72 C14.8 42.86, 26.15 30.96, 49.99 2.38 M2.49 63.11 C14.32 51.14, 24.28 37.89, 55.63 1.98 M2.49 63.11 C17.09 46.61, 31.96 30.07, 55.63 1.98 M2.88 68.76 C17.36 53.9, 29.82 36.17, 60.62 2.34 M2.88 68.76 C16.39 51.57, 30.24 37.34, 60.62 2.34 M2.62 75.16 C16.74 60.09, 29.25 43, 66.26 1.95 M2.62 75.16 C24.45 49.83, 44.8 27.24, 66.26 1.95 M2.36 81.55 C21.56 58.65, 40.58 36.5, 71.25 2.31 M2.36 81.55 C27.4 54.5, 51.99 24.74, 71.25 2.31 M2.76 87.2 C28.67 57.05, 55.74 25.13, 76.89 1.91 M2.76 87.2 C28.41 56.59, 54.76 26.9, 76.89 1.91 M2.49 93.59 C25.54 65.25, 52.53 37.73, 81.88 2.27 M2.49 93.59 C25.27 66.32, 50.31 39.36, 81.88 2.27 M2.89 99.24 C25.42 73.47, 45.64 49.26, 87.52 1.88 M2.89 99.24 C26.14 72.75, 48.56 46.49, 87.52 1.88 M2.63 105.64 C34.97 72.27, 66.9 34.6, 92.51 2.24 M2.63 105.64 C36.64 63.61, 71.73 24.13, 92.51 2.24 M2.37 112.03 C32.14 75.2, 61.23 43.38, 98.15 1.85 M2.37 112.03 C23.23 87.97, 43.62 62.22, 98.15 1.85 M2.76 117.68 C42.66 72.76, 82.27 26.38, 103.14 2.21 M2.76 117.68 C23.58 92.42, 44.35 66.98, 103.14 2.21 M2.5 124.07 C39.16 86.85, 72.53 47.13, 108.78 1.81 M2.5 124.07 C43.3 77.09, 83.89 29.71, 108.78 1.81 M2.89 129.72 C30.69 102.57, 53.41 72, 113.77 2.17 M2.89 129.72 C41.59 85.12, 78.81 40.66, 113.77 2.17 M2.63 136.11 C28.15 105.25, 56.68 74.81, 119.41 1.78 M2.63 136.11 C45.05 88.16, 86.98 40.17, 119.41 1.78 M2.37 142.51 C46.31 90.74, 93 38.12, 124.4 2.14 M2.37 142.51 C49.16 88.47, 95.28 33.94, 124.4 2.14 M2.77 148.16 C50.58 92.08, 98.48 36.82, 130.04 1.74 M2.77 148.16 C48.54 94.49, 92.29 44.21, 130.04 1.74 M2.5 154.55 C52.43 95.89, 100.6 38.84, 135.03 2.1 M2.5 154.55 C52.92 96.03, 102.97 37.66, 135.03 2.1 M2.9 160.2 C41.27 114.1, 78.63 71.07, 140.67 1.71 M2.9 160.2 C36.27 124.15, 67.47 86.07, 140.67 1.71 M3.29 165.84 C49.16 111.13, 94.48 59.26, 145.66 2.07 M3.29 165.84 C58.35 103.28, 113.26 40.09, 145.66 2.07 M4.34 170.73 C36.01 133.89, 67.84 96.32, 150.65 2.43 M4.34 170.73 C43.33 126.91, 80.48 82.61, 150.65 2.43 M4.74 176.37 C47.62 125.34, 92.82 76.01, 156.29 2.03 M4.74 176.37 C46.71 125.96, 89.59 77.48, 156.29 2.03 M7.76 179 C44.29 134.78, 84.02 92.8, 161.28 2.39 M7.76 179 C59.38 120.84, 111.97 60.79, 161.28 2.39 M10.78 181.62 C62.97 126.46, 112.21 67.95, 166.92 2 M10.78 181.62 C70.07 113.13, 130.38 44.02, 166.92 2 M13.8 184.24 C46.96 147.04, 77.96 110.97, 171.91 2.36 M13.8 184.24 C73.82 115.62, 133.36 46.74, 171.91 2.36 M17.47 186.11 C53.35 144.33, 92.53 100.6, 177.55 1.96 M17.47 186.11 C54.75 142.34, 92.54 100.64, 177.55 1.96 M21.8 187.23 C67.84 134.28, 114.69 81.77, 182.54 2.32 M21.8 187.23 C75.45 125.52, 128.83 64.08, 182.54 2.32 M25.48 189.1 C61.42 150.39, 95.39 108.5, 188.18 1.93 M25.48 189.1 C85.72 120.14, 147.07 49.59, 188.18 1.93 M31.12 188.7 C80.11 132.76, 128.03 75.97, 193.17 2.29 M31.12 188.7 C93.39 118.27, 156.03 47.84, 193.17 2.29 M34.79 190.57 C77.88 142.76, 118.86 92.92, 198.81 1.9 M34.79 190.57 C98.82 116.62, 164.47 42.84, 198.81 1.9 M39.78 190.93 C102.75 118.76, 167.86 44.87, 203.8 2.26 M39.78 190.93 C89.99 131.66, 141.22 71.78, 203.8 2.26 M45.42 190.54 C95.43 135.56, 144.97 76.61, 209.44 1.86 M45.42 190.54 C96.07 129.73, 148.7 71.34, 209.44 1.86 M50.41 190.9 C95.53 136.42, 144.4 82.32, 214.43 2.22 M50.41 190.9 C108.7 125.93, 165.75 59.53, 214.43 2.22 M56.05 190.5 C101.72 140.78, 143.73 91.17, 220.07 1.83 M56.05 190.5 C114.64 122.62, 173.58 54.08, 220.07 1.83 M61.04 190.86 C112.26 130.95, 164.14 73.1, 225.06 2.19 M61.04 190.86 C118.13 126.99, 174.82 60.77, 225.06 2.19 M66.68 190.47 C107.49 144.18, 146.36 99.45, 230.7 1.79 M66.68 190.47 C132.82 115.74, 198.59 40.32, 230.7 1.79 M71.67 190.83 C125.73 125.46, 182.27 64.06, 235.69 2.15 M71.67 190.83 C131.72 120.51, 193.01 51.5, 235.69 2.15 M77.31 190.43 C129 131.95, 179.01 76.01, 241.33 1.76 M77.31 190.43 C127.05 131.7, 177.28 73.48, 241.33 1.76 M82.3 190.79 C120.62 145.64, 158.52 102.8, 246.32 2.12 M82.3 190.79 C132.56 130.97, 184.21 71.42, 246.32 2.12 M87.94 190.4 C139.26 131.53, 190.96 72.53, 251.96 1.72 M87.94 190.4 C154.33 115.44, 220.01 40.81, 251.96 1.72 M92.93 190.76 C127.16 151.69, 162.92 107.21, 256.95 2.08 M92.93 190.76 C142.45 131.65, 192.85 73.07, 256.95 2.08 M98.57 190.37 C143.29 139.92, 185.65 90.34, 262.59 1.69 M98.57 190.37 C132.59 151.05, 167.69 111.59, 262.59 1.69 M103.56 190.73 C154.52 131.65, 207.54 72, 267.58 2.05 M103.56 190.73 C151.62 135.73, 201.39 78.66, 267.58 2.05 M109.2 190.33 C171.34 119.79, 233.25 47.37, 272.56 2.41 M109.2 190.33 C157.11 134.63, 204.88 80.53, 272.56 2.41 M114.19 190.69 C165.53 134.32, 214.67 75.51, 278.21 2.01 M114.19 190.69 C154.54 142.87, 197.44 93.82, 278.21 2.01 M119.83 190.3 C154.89 152.22, 190.47 113.22, 283.19 2.37 M119.83 190.3 C159.16 144.39, 199.33 99.51, 283.19 2.37 M124.82 190.66 C184.35 125.24, 239.26 58.37, 288.84 1.98 M124.82 190.66 C186.07 119.88, 247.47 48.83, 288.84 1.98 M130.46 190.26 C181.52 131.38, 232.15 71.59, 293.82 2.34 M130.46 190.26 C173.99 142.32, 216.45 93.59, 293.82 2.34 M135.45 190.62 C195.39 120.92, 256.31 51.4, 299.47 1.94 M135.45 190.62 C180.38 138.14, 226.26 85.44, 299.47 1.94 M141.09 190.23 C174.29 150.6, 207.87 114.13, 304.45 2.3 M141.09 190.23 C203.5 116.02, 268.02 42.93, 304.45 2.3 M146.08 190.59 C191.5 138.12, 238.82 83.6, 310.75 1.16 M146.08 190.59 C182.65 149.23, 217.35 109.11, 310.75 1.16 M151.72 190.19 C219.06 116.1, 283.02 42.2, 315.74 1.52 M151.72 190.19 C196.88 137.18, 243.82 83.67, 315.74 1.52 M156.71 190.55 C219.87 118.92, 281.17 46.27, 320.07 2.63 M156.71 190.55 C199.19 142.16, 242.47 93.37, 320.07 2.63 M161.7 190.91 C216.58 127.59, 272.46 64.38, 324.4 3.75 M161.7 190.91 C199.14 147.74, 235.62 105.74, 324.4 3.75 M167.34 190.52 C219.96 132.95, 268.61 74.87, 328.08 5.61 M167.34 190.52 C216.29 134.5, 265.4 77.58, 328.08 5.61 M172.33 190.88 C220.05 137.8, 264.99 85.07, 332.41 6.73 M172.33 190.88 C224.96 129.06, 276.85 67.42, 332.41 6.73 M177.97 190.48 C224.98 134.03, 277.39 74.47, 334.77 10.11 M177.97 190.48 C221.64 141.2, 265.62 91.7, 334.77 10.11 M182.96 190.84 C223.66 143.55, 266.02 92.68, 337.79 12.73 M182.96 190.84 C233.4 133.55, 285.65 73.55, 337.79 12.73 M188.6 190.45 C249.52 123.31, 307.14 54.46, 339.5 16.87 M188.6 190.45 C237.52 132.96, 286.13 77.24, 339.5 16.87 M193.59 190.81 C234.59 145.4, 273.72 100.25, 341.86 20.25 M193.59 190.81 C252.28 125.27, 309.75 59.46, 341.86 20.25 M199.23 190.42 C249.18 135.38, 295.74 78.72, 342.91 25.13 M199.23 190.42 C228.67 156.12, 258.63 122.06, 342.91 25.13 M204.22 190.78 C239.53 149.81, 277.89 105.15, 341.99 32.29 M204.22 190.78 C243.82 144.46, 283.4 99.91, 341.99 32.29 M209.86 190.38 C249.55 145.83, 290.95 97.17, 342.39 37.93 M209.86 190.38 C254.3 137.56, 299.93 85.19, 342.39 37.93 M214.85 190.74 C240.34 157.45, 269.62 126.92, 342.12 44.33 M214.85 190.74 C242.08 158.65, 271.21 125.11, 342.12 44.33 M220.49 190.35 C248.66 156.45, 274.33 125.65, 341.86 50.72 M220.49 190.35 C261.02 143.74, 301.36 98.18, 341.86 50.72 M225.48 190.71 C252.32 162.3, 277.39 132.27, 342.26 56.37 M225.48 190.71 C256.61 155.31, 286.1 120.47, 342.26 56.37 M231.12 190.31 C256.96 162.6, 279.04 134.71, 342 62.77 M231.12 190.31 C258.03 159.1, 285 127.14, 342 62.77 M236.11 190.67 C277.32 145.11, 317.16 98.49, 342.39 68.41 M236.11 190.67 C260.74 161.74, 285.05 132.41, 342.39 68.41 M241.75 190.28 C279.45 149.13, 314.12 108.13, 342.13 74.81 M241.75 190.28 C275.78 150.95, 308.35 113.82, 342.13 74.81 M246.74 190.64 C284.66 150.08, 319.24 106.32, 341.87 81.2 M246.74 190.64 C268.5 163.72, 290.93 138.4, 341.87 81.2 M252.38 190.24 C279.02 158.74, 304.85 127.53, 342.26 86.85 M252.38 190.24 C280.67 157.82, 307.94 127.58, 342.26 86.85 M257.37 190.6 C280.58 163.95, 301.46 141.43, 342 93.25 M257.37 190.6 C289.54 153.92, 321.15 116.05, 342 93.25 M263.01 190.21 C284.8 164.76, 310.73 140.15, 342.4 98.89 M263.01 190.21 C285.23 164.78, 306.89 140.92, 342.4 98.89 M268 190.57 C285.6 171.12, 302.09 151.45, 342.13 105.29 M268 190.57 C296.69 157.21, 325.51 122.9, 342.13 105.29 M272.99 190.93 C297.98 164.47, 317.98 138.35, 341.87 111.68 M272.99 190.93 C286.54 174.62, 299.66 157.77, 341.87 111.68 M278.63 190.53 C298.91 167.1, 318.71 146.03, 342.27 117.33 M278.63 190.53 C294.06 173.16, 310.64 153.8, 342.27 117.33 M283.62 190.89 C308.6 164.29, 327.85 137.74, 342.01 123.72 M283.62 190.89 C297.85 173.94, 314.25 158.25, 342.01 123.72 M289.26 190.5 C300.33 174.13, 313.72 159.12, 342.4 129.37 M289.26 190.5 C305.32 170.81, 323.02 151.09, 342.4 129.37 M294.25 190.86 C305.75 174.79, 318.54 161.68, 342.14 135.77 M294.25 190.86 C304.99 179.67, 316.03 167.78, 342.14 135.77 M299.89 190.46 C317.48 169.79, 335.15 153.05, 341.88 142.16 M299.89 190.46 C307.65 179.57, 317.31 170.28, 341.88 142.16 M304.88 190.82 C316.19 178.05, 325.51 168.66, 342.27 147.81 M304.88 190.82 C317.26 177.09, 330.25 162.06, 342.27 147.81 M311.18 189.68 C321.66 181.21, 330.33 170.19, 342.01 154.2 M311.18 189.68 C322.69 175.73, 333.6 164.3, 342.01 154.2 M317.48 188.53 C324.98 180.98, 333.11 171.34, 344.37 157.58 M317.48 188.53 C322.65 181.64, 330.08 173.47, 344.37 157.58 M324.43 186.62 C327.32 181.14, 334.01 176.81, 343.46 164.74 M324.43 186.62 C328.67 180.35, 333.63 175.63, 343.46 164.74" stroke="#a5d8ff" stroke-width="0.5" fill="none"></path><path d="M32 0 M32 0 C100.06 -0.91, 168.65 -0.49, 309.96 0 M32 0 C139.72 0.94, 246.83 1.2, 309.96 0 M309.96 0 C330.01 -1.49, 340.2 9.18, 341.96 32 M309.96 0 C331.17 2.21, 341.82 11.7, 341.96 32 M341.96 32 C343.24 82.71, 341.39 131.26, 341.96 156.13 M341.96 32 C342.05 70.9, 341.75 111.59, 341.96 156.13 M341.96 156.13 C340.86 177.66, 330.7 187.05, 309.96 188.13 M341.96 156.13 C342.03 177.24, 329.26 188.57, 309.96 188.13 M309.96 188.13 C201.33 189.01, 95.22 190.72, 32 188.13 M309.96 188.13 C208.7 188.14, 107.4 188.87, 32 188.13 M32 188.13 C8.77 187.95, 0.47 176.1, 0 156.13 M32 188.13 C9.22 188.32, 0.5 175.49, 0 156.13 M0 156.13 C0.38 129.27, -1.19 100.11, 0 32 M0 156.13 C0.38 116.78, 1.1 79.99, 0 32 M0 32 C1.59 12.21, 11.29 -1.57, 32 0 M0 32 C0.01 12.23, 8.87 -0.51, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(354.16256561297223 421.38374640556555) rotate(0 171.342157545872 -0.038639475521847544)"><path d="M1.02 0.27 C58.02 0.57, 285.75 0.92, 342.59 0.83 M0.09 -0.63 C56.98 -0.59, 285.24 -1.11, 342.15 -0.85" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(360.8691358105209 387.4548483431923) rotate(0 80.19992065429688 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">r4l_gmac_xmit()</text></g><g transform="translate(367.2807458243641 431.227366635657) rotate(0 157.15985107421875 62.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">dwmac_desc_set_addr()</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">dwmac_prepare_tx_desc()</text><text x="0" y="50" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">netdev_tx_sent_queue()</text><text x="0" y="75" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">dwmac_dma_set_tx_tail_ptr()</text><text x="0" y="100" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">r4l_gmac_tx_clean()</text></g><g stroke-linecap="round"><g transform="translate(243.81051254169685 76.12980417148128) rotate(0 11.956555244659285 -0.024088812486979805)"><path d="M0.46 -1.01 C4.39 -1.13, 20.63 -1.16, 24.67 -1.07 M-0.76 1.07 C2.91 1.1, 19.58 -0.02, 23.69 -0.1" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(243.81051254169685 76.12980417148128) rotate(0 11.956555244659285 -0.024088812486979805)"><path d="M11.23 4.59 C15.64 2.71, 20.73 0.94, 22.77 -0.71 M12.05 4.82 C16.55 2.46, 21.09 1.54, 24.25 -0.44" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(243.81051254169685 76.12980417148128) rotate(0 11.956555244659285 -0.024088812486979805)"><path d="M10.84 -3.86 C15.38 -2.44, 20.62 -0.91, 22.77 -0.71 M11.66 -3.63 C16.29 -2.9, 20.99 -0.72, 24.25 -0.44" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(441.3356552429368 67.09948442175687) rotate(0 13.714664271503636 1.58003096920973)"><path d="M1.13 1.06 C5.74 1.63, 22.82 2.25, 27.16 2.59 M0.27 0.57 C4.83 0.83, 22.23 0.49, 26.66 0.59" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(441.3356552429368 67.09948442175687) rotate(0 13.714664271503636 1.58003096920973)"><path d="M15.42 6.05 C17.8 4.75, 21.64 3.25, 26.14 0.28 M14.32 4.95 C18.33 3.68, 21.56 2.67, 26.63 0.89" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(441.3356552429368 67.09948442175687) rotate(0 13.714664271503636 1.58003096920973)"><path d="M15.41 -2.99 C17.74 -1.91, 21.57 -1.03, 26.14 0.28 M14.32 -4.09 C18.24 -2.58, 21.48 -0.82, 26.63 0.89" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(560.2997918502429 142.875335835013) rotate(0 0.4727724050057418 14.943228778022558)"><path d="M-0.51 -0.1 C-0.46 5.19, 1.18 25.89, 1.46 31.09 M1.42 -1.2 C1.2 3.78, 0.66 24.18, 0.45 29.21" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(560.2997918502429 142.875335835013) rotate(0 0.4727724050057418 14.943228778022558)"><path d="M-4.44 14.48 C-1.9 19.92, -0.01 26.24, 0.68 27.86 M-3.79 14.65 C-3.24 17.37, -2.83 21.27, 0.46 29.27" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(560.2997918502429 142.875335835013) rotate(0 0.4727724050057418 14.943228778022558)"><path d="M6.04 14.83 C4.4 20.08, 2.12 26.27, 0.68 27.86 M6.7 15 C4.97 17.71, 3.11 21.54, 0.46 29.27" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(469.99698376264155 242.60098859214878) rotate(0 -11.90732293758208 -0.12116775879127317)"><path d="M-0.95 0.11 C-4.86 0.34, -20.72 0.8, -24.57 0.83 M0.76 -0.88 C-2.66 -0.93, -17.92 -1.29, -22.19 -0.86" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(469.99698376264155 242.60098859214878) rotate(0 -11.90732293758208 -0.12116775879127317)"><path d="M-10.97 -5.94 C-12.58 -4.58, -15.47 -2.88, -22.49 0.32 M-11.08 -5.33 C-13.08 -4.85, -15.55 -3.9, -22.5 -0.34" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(469.99698376264155 242.60098859214878) rotate(0 -11.90732293758208 -0.12116775879127317)"><path d="M-10.7 2.25 C-12.32 1.9, -15.28 1.91, -22.49 0.32 M-10.82 2.85 C-12.85 1.53, -15.38 0.68, -22.5 -0.34" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(278.09465698006954 345.27129715796985) rotate(0 -40.58246170900517 13.18529422324292)"><path d="M-1.06 0.13 C-14.79 4.58, -67.81 21.67, -81.38 25.8 M0.59 -0.85 C-13.3 3.87, -67.78 22.81, -81.76 27.22" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(278.09465698006954 345.27129715796985) rotate(0 -40.58246170900517 13.18529422324292)"><path d="M-58.05 10.39 C-67.85 15.57, -78.43 21.48, -83.57 26.54 M-58.52 7.62 C-63.09 11.5, -68.48 16.5, -82.56 27.39" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(278.09465698006954 345.27129715796985) rotate(0 -40.58246170900517 13.18529422324292)"><path d="M-51.56 29.86 C-63.72 27.44, -76.81 25.82, -83.57 26.54 M-52.03 27.09 C-57.93 26.89, -64.68 27.82, -82.56 27.39" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(337.71122959656327 343.70083802367475) rotate(0 29.585627512575286 13.679884246618144)"><path d="M0.53 -1.1 C10.59 3.57, 50.21 23.83, 59.83 28.46 M-0.66 0.93 C9.39 5.21, 49.8 22.27, 59.44 26.69" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(337.71122959656327 343.70083802367475) rotate(0 29.585627512575286 13.679884246618144)"><path d="M27.66 26.58 C38.24 24.24, 42.91 23.8, 57.8 26.07 M28.92 24.71 C38.72 24.82, 47.47 26.11, 59.79 27.16" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(337.71122959656327 343.70083802367475) rotate(0 29.585627512575286 13.679884246618144)"><path d="M35.88 7.77 C44.44 10.25, 47.02 14.59, 57.8 26.07 M37.14 5.91 C44.52 11.81, 50.75 18.89, 59.79 27.16" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask></svg><div style="break-before: page; page-break-before: always;"></div><h1 id="其它-1"><a class="header" href="#其它-1">其它</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="其它-2"><a class="header" href="#其它-2">其它</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="depth-1-情况下切换分支"><a class="header" href="#depth-1-情况下切换分支">depth 1 情况下切换分支</a></h1>
<p>在大型工程，特别是 git commit 记录特别多的工程中，如 linux，clone 时如果加入 <code>--depth 1</code>选项将使速度大大减小下载内容，同时提高成功率、加快完成速度。但这种情况下本地仓库将只有主分支，没有其它分支的记录，这里记录进一步添加远程分支，并在本地同步的方法。</p>
<h2 id="操作步骤"><a class="header" href="#操作步骤">操作步骤</a></h2>
<ol>
<li>clone 远程仓库</li>
</ol>
<pre><code class="language-bash">$ git clone xxx.git --depth 1
</code></pre>
<ol start="2">
<li>查看本地仓库的分支记录</li>
</ol>
<pre><code class="language-bash">$ git branch -a
* main
  remotes/origin/HEAD -&gt; origin/main
  remotes/origin/main
</code></pre>
<p>可以看到远程分支的信息只有 origin/main，此时无法 checkout 到其它分支中工作。</p>
<ol start="3">
<li>添加远程分支</li>
</ol>
<pre><code class="language-bash">$ git remote set-branches origin dev1
$ git fetch origin dev1 --depth 1
$ git remote set-branches origin dev2
$ git fetch origin dev2 --depth 1
$ git branch -a
* main
  remotes/origin/HEAD -&gt; origin/main
  remotes/origin/main
  remotes/origin/dev1
  remotes/origin/dev2
</code></pre>
<p>这样本地仓库就有远程分支的信息</p>
<ol start="4">
<li>创建对应的本地分支</li>
</ol>
<pre><code class="language-bash">$ git checkout -b dev1 origin/dev1
$ git branch -a
  main
* dev1
  remotes/origin/HEAD -&gt; origin/main
  remotes/origin/main
  remotes/origin/dev1
  remotes/origin/dev2
</code></pre>
<p>这样即可在本地创建与远程分支关联的本地分支，并 checkout 到次分支中。</p>
<ol start="5">
<li>合并远程分支
此时往往需要将远程某个分支的内容拉取到本地，并继续做开发，如将 <code>origin/dev2</code> 拉取到 <code>dev1</code>，使用简单 <code>merge</code> 命令，可能会提示 <code>unrelated histories</code> 相关的错误，这是因为本地仓库的 commit 记录只有1层，git 认为这两个分支是不相关，默认不可以合并，可以添加 <code>--allow-unrelated-histories</code> 忽略此检查</li>
</ol>
<pre><code class="language-bash">$ git branch
  main
* dev1
$ git merge origin/dev2 --allow-unrelated-histories
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iic-驱动开发"><a class="header" href="#iic-驱动开发">IIC 驱动开发</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
